StmtText                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               StmtId      NodeId      Parent      PhysicalOp                     LogicalOp                      Argument                                                                                                                                                                                                                                                                                                                                                                                                                                    DefinedValues                                                                                                                                                                                                                 EstimateRows   EstimateIO     EstimateCPU    AvgRowSize  TotalSubtreeCost OutputList                                                                                                    Warnings Type                                                             Parallel EstimateExecutions
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ ----------- ----------- ----------- ------------------------------ ------------------------------ ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------- -------------- -------------- ----------- ---------------- ------------------------------------------------------------------------------------------------------------- -------- ---------------------------------------------------------------- -------- ------------------

select
top 100
	s_name,
	count(*) as numwait
from
	supplier,
	lineitem l1,
	orders,
	nation
where
	s_suppkey = l1.l_suppkey
	and o_orderkey = l1.l_orderkey
	and o_orderstatus = 'F'
	and l1.l_receiptdate > l1.l_commitdate
	and exists (
		select
			*
		from
			lineitem l2
		where
			l2.l_orderkey = l1.l_orderkey
			and l2.l_suppkey <> l1.l_suppkey
	)
	and not exists (
		select
			*
		from
			lineitem l3
		where
			l3.l_orderkey = l1.l_orderkey
			and l3.l_suppkey <> l1.l_suppkey
			and l3.l_receiptdate > l3.l_commitdate
	)
	and s_nationkey = n_nationkey
	and n_name = 'MOZAMBIQUE'
group by
	s_name
order by
	numwait desc,
	s_name;              1           1           0 NULL                           NULL                           1                                                                                                                                                                                                                                                                                                                                                                                                                                           NULL                                                                                                                                                                                                                                   100.0           NULL           NULL        NULL        2546.3081 NULL                                                                                                          NULL     SELECT                                                                  0               NULL
  |--Top(TOP EXPRESSION:((100)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 1           2           1 Top                            Top                            TOP EXPRESSION:((100))                                                                                                                                                                                                                                                                                                                                                                                                                      NULL                                                                                                                                                                                                                                   100.0            0.0   9.9999997E-6          33        2546.3081 [TPCH].[dbo].[supplier].[S_Name], [Expr1011]                                                                  NULL     PLAN_ROW                                                                0                1.0
       |--Parallelism(Gather Streams, ORDER BY:([Expr1011] DESC, [TPCH].[dbo].[supplier].[S_Name] ASC))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          1           3           2 Parallelism                    Gather Streams                 ORDER BY:([Expr1011] DESC, [TPCH].[dbo].[supplier].[S_Name] ASC)                                                                                                                                                                                                                                                                                                                                                                            NULL                                                                                                                                                                                                                                   100.0            0.0   2.9114325E-2          33        2546.3081 [TPCH].[dbo].[supplier].[S_Name], [Expr1011]                                                                  NULL     PLAN_ROW                                                               -1                1.0
            |--Sort(TOP 100, ORDER BY:([Expr1011] DESC, [TPCH].[dbo].[supplier].[S_Name] ASC))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   1           4           3 Sort                           TopN Sort                      TOP 100, ORDER BY:([Expr1011] DESC, [TPCH].[dbo].[supplier].[S_Name] ASC)                                                                                                                                                                                                                                                                                                                                                                   NULL                                                                                                                                                                                                                                   100.0   9.3843846E-4   1.8916111E-3          33        2546.2791 [TPCH].[dbo].[supplier].[S_Name], [Expr1011]                                                                  NULL     PLAN_ROW                                                               -1                1.0
                 |--Compute Scalar(DEFINE:([Expr1011]=CONVERT_IMPLICIT(int,[Expr1143],0)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       1           5           4 Compute Scalar                 Compute Scalar                 DEFINE:([Expr1011]=CONVERT_IMPLICIT(int,[Expr1143],0))                                                                                                                                                                                                                                                                                                                                                                                      [Expr1011]=CONVERT_IMPLICIT(int,[Expr1143],0)                                                                                                                                                                                      3999.8862            0.0            0.0          33        2546.2764 [TPCH].[dbo].[supplier].[S_Name], [Expr1011]                                                                  NULL     PLAN_ROW                                                               -1                1.0
                      |--Hash Match(Aggregate, HASH:([TPCH].[dbo].[supplier].[S_Name]), RESIDUAL:([TPCH].[dbo].[supplier].[S_Name] = [TPCH].[dbo].[supplier].[S_Name]) DEFINE:([Expr1143]=COUNT(*)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             1           6           5 Hash Match                     Aggregate                      HASH:([TPCH].[dbo].[supplier].[S_Name]), RESIDUAL:([TPCH].[dbo].[supplier].[S_Name] = [TPCH].[dbo].[supplier].[S_Name])                                                                                                                                                                                                                                                                                                                     [Expr1143]=COUNT(*)                                                                                                                                                                                                                3999.8862            0.0   6.7984171E-2          33        2546.2764 [TPCH].[dbo].[supplier].[S_Name], [Expr1143]                                                                  NULL     PLAN_ROW                                                               -1                1.0
                           |--Adaptive Join                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      1           7           6 Adaptive Join                  Left Anti Semi Join            NULL                                                                                                                                                                                                                                                                                                                                                                                                                                        [TPCH].[dbo].[supplier].[S_Name] = ([TPCH].[dbo].[supplier].[S_Name], [TPCH].[dbo].[supplier].[S_Name])                                                                                                                             351751.5            0.0   1.7587575E-3          29          2546.21 [TPCH].[dbo].[supplier].[S_Name]                                                                              NULL     PLAN_ROW                                                               -1                1.0
                                |--Adaptive Join                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 1           9           7 Adaptive Join                  Left Semi Join                 NULL                                                                                                                                                                                                                                                                                                                                                                                                                                        [TPCH].[dbo].[supplier].[S_Name] = ([TPCH].[dbo].[supplier].[S_Name], [TPCH].[dbo].[supplier].[S_Name]), [l1].[L_OrderKey] = ([l1].[L_OrderKey], [l1].[L_OrderKey]), [l1].[L_SuppKey] = ([l1].[L_SuppKey], [l1].[L_SuppKey])       351755.12            0.0   1.7587756E-3          37        1753.9427 [TPCH].[dbo].[supplier].[S_Name], [l1].[L_OrderKey], [l1].[L_SuppKey]                                         NULL     PLAN_ROW                                                               -1                1.0
                                |    |--Adaptive Join                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            1          11           9 Adaptive Join                  Inner Join                     NULL                                                                                                                                                                                                                                                                                                                                                                                                                                        [TPCH].[dbo].[supplier].[S_Name] = ([TPCH].[dbo].[supplier].[S_Name], [TPCH].[dbo].[supplier].[S_Name]), [l1].[L_OrderKey] = ([l1].[L_OrderKey], [l1].[L_OrderKey]), [l1].[L_SuppKey] = ([l1].[L_SuppKey], [l1].[L_SuppKey])       351755.12            0.0   1.7587756E-3          37         968.8266 [TPCH].[dbo].[supplier].[S_Name], [l1].[L_OrderKey], [l1].[L_SuppKey]                                         NULL     PLAN_ROW                                                               -1                1.0
                                |    |    |--Hash Match(Inner Join, HASH:([TPCH].[dbo].[supplier].[S_SuppKey])=([l1].[L_SuppKey]), RESIDUAL:([TPCH].[dbo].[supplier].[S_SuppKey]=[TPCH].[dbo].[lineitem].[L_SuppKey] as [l1].[L_SuppKey])DEFINE:([Opt_Bitmap1093]))                                                                                                                                                                                                                                                                                                                                                                                                                                              1          13          11 Hash Match                     Inner Join                     HASH:([TPCH].[dbo].[supplier].[S_SuppKey])=([l1].[L_SuppKey]), RESIDUAL:([TPCH].[dbo].[supplier].[S_SuppKey]=[TPCH].[dbo].[lineitem].[L_SuppKey] as [l1].[L_SuppKey])                                                                                                                                                                                                                                                                       [Opt_Bitmap1093]                                                                                                                                                                                                                   719840.06            0.0     0.26522091          37        793.73236 [TPCH].[dbo].[supplier].[S_Name], [l1].[L_OrderKey], [l1].[L_SuppKey]                                         NULL     PLAN_ROW                                                               -1                1.0
                                |    |    |    |--Hash Match(Inner Join, HASH:([TPCH].[dbo].[nation].[N_NationKey])=([TPCH].[dbo].[supplier].[S_NationKey]), RESIDUAL:([TPCH].[dbo].[supplier].[S_NationKey]=[TPCH].[dbo].[nation].[N_NationKey])DEFINE:([Opt_Bitmap1080]))                                                                                                                                                                                                                                                                                                                                                                                                                                      1          14          13 Hash Match                     Inner Join                     HASH:([TPCH].[dbo].[nation].[N_NationKey])=([TPCH].[dbo].[supplier].[S_NationKey]), RESIDUAL:([TPCH].[dbo].[supplier].[S_NationKey]=[TPCH].[dbo].[nation].[N_NationKey])                                                                                                                                                                                                                                                                    [Opt_Bitmap1080]                                                                                                                                                                                                                      4000.0            0.0   3.2253938E-3          33        1.4844491 [TPCH].[dbo].[supplier].[S_SuppKey], [TPCH].[dbo].[supplier].[S_Name]                                         NULL     PLAN_ROW                                                               -1                1.0
                                |    |    |    |    |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[nation].[PK__nation__BD3779521509254A]),  WHERE:([TPCH].[dbo].[nation].[N_Name]='MOZAMBIQUE'))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 1          15          14 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[nation].[PK__nation__BD3779521509254A]),  WHERE:([TPCH].[dbo].[nation].[N_Name]='MOZAMBIQUE')                                                                                                                                                                                                                                                                                                                         [TPCH].[dbo].[nation].[N_NationKey]                                                                                                                                                                                                      1.0       0.003125   4.6124998E-5          22      3.171125E-3 [TPCH].[dbo].[nation].[N_NationKey]                                                                           NULL     PLAN_ROW                                                               -1                1.0
                                |    |    |    |    |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[supplier].[PK__supplier__C9D8C8B7D7E219CD]),  WHERE:(PROBE([Opt_Bitmap1080],[TPCH].[dbo].[supplier].[S_NationKey])))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           1          17          14 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[supplier].[PK__supplier__C9D8C8B7D7E219CD]),  WHERE:(PROBE([Opt_Bitmap1080],[TPCH].[dbo].[supplier].[S_NationKey]))                                                                                                                                                                                                                                                                                                   [TPCH].[dbo].[supplier].[S_SuppKey], [TPCH].[dbo].[supplier].[S_Name], [TPCH].[dbo].[supplier].[S_NationKey]                                                                                                                         10000.0      1.4505324   2.7514249E-2          37        1.4780467 [TPCH].[dbo].[supplier].[S_SuppKey], [TPCH].[dbo].[supplier].[S_Name], [TPCH].[dbo].[supplier].[S_NationKey]  NULL     PLAN_ROW                                                               -1                1.0
                                |    |    |    |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C] AS [l1]),  WHERE:([TPCH].[dbo].[lineitem].[L_ReceiptDate] as [l1].[L_ReceiptDate]>[TPCH].[dbo].[lineitem].[L_CommitDate] as [l1].[L_CommitDate] AND PROBE([Opt_Bitmap1093],[TPCH].[dbo].[lineitem].[L_SuppKey] as [l1].[L_SuppKey])))                                                                                                                                                                                                                                                                                                                                    1          19          13 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C] AS [l1]),  WHERE:([TPCH].[dbo].[lineitem].[L_ReceiptDate] as [l1].[L_ReceiptDate]>[TPCH].[dbo].[lineitem].[L_CommitDate] as [l1].[L_CommitDate] AND PROBE([Opt_Bitmap1093],[TPCH].[dbo].[lineitem].[L_SuppKey] as [l1].[L_SuppKey]))                                                                                                                                       [l1].[L_OrderKey], [l1].[L_SuppKey]                                                                                                                                                                                                1799581.6       768.3031      16.481207          31         784.7843 [l1].[L_OrderKey], [l1].[L_SuppKey]                                                                           NULL     PLAN_ROW                                                               -1                1.0
                                |    |    |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[orders].[PK__orders__0F8A125214F3A7C2]),  WHERE:([TPCH].[dbo].[orders].[O_OrderStatus]='F' AND PROBE([Opt_Bitmap1132],[TPCH].[dbo].[orders].[O_OrderKey])))                                                                                                                                                                                                                                                                                                                                                                                                                                                              1          21          13 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[orders].[PK__orders__0F8A125214F3A7C2]),  WHERE:([TPCH].[dbo].[orders].[O_OrderStatus]='F' AND PROBE([Opt_Bitmap1132],[TPCH].[dbo].[orders].[O_OrderKey]))                                                                                                                                                                                                                                                            [TPCH].[dbo].[orders].[O_OrderKey]                                                                                                                                                                                                 732986.06      168.57867      4.1212893          16        172.69997 [TPCH].[dbo].[orders].[O_OrderKey]                                                                            NULL     PLAN_ROW                                                               -1                1.0
                                |    |    |--Clustered Index Seek(OBJECT:([TPCH].[dbo].[orders].[PK__orders__0F8A125214F3A7C2]), SEEK:([TPCH].[dbo].[orders].[O_OrderKey]=[TPCH].[dbo].[lineitem].[L_OrderKey] as [l1].[L_OrderKey]),  WHERE:([TPCH].[dbo].[orders].[O_OrderStatus]='F') ORDERED FORWARD)                                                                                                                                                                                                                                                                                                                                                                                                        1          25          11 Clustered Index Seek           Clustered Index Seek           OBJECT:([TPCH].[dbo].[orders].[PK__orders__0F8A125214F3A7C2]), SEEK:([TPCH].[dbo].[orders].[O_OrderKey]=[TPCH].[dbo].[lineitem].[L_OrderKey] as [l1].[L_OrderKey]),  WHERE:([TPCH].[dbo].[orders].[O_OrderStatus]='F') ORDERED FORWARD                                                                                                                                                                                                      NULL                                                                                                                                                                                                                                     1.0       0.003125      0.0001581          12        1980.4253 NULL                                                                                                          NULL     PLAN_ROW                                                               -1          719840.06
                                |    |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C] AS [l2]),  WHERE:(PROBE([Opt_Bitmap1138],[TPCH].[dbo].[lineitem].[L_OrderKey] as [l2].[L_OrderKey])))                                                                                                                                                                                                                                                                                                                                                                                                                                                                              1          27          11 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C] AS [l2]),  WHERE:(PROBE([Opt_Bitmap1138],[TPCH].[dbo].[lineitem].[L_OrderKey] as [l2].[L_OrderKey]))                                                                                                                                                                                                                                                                       [l2].[L_OrderKey], [l2].[L_SuppKey]                                                                                                                                                                                                 599860.5       768.3031      16.481207          15         784.7843 [l2].[L_OrderKey], [l2].[L_SuppKey]                                                                           NULL     PLAN_ROW                                                               -1                1.0
                                |    |--Clustered Index Seek(OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C] AS [l2]), SEEK:([l2].[L_OrderKey]=[TPCH].[dbo].[lineitem].[L_OrderKey] as [l1].[L_OrderKey]),  WHERE:([TPCH].[dbo].[lineitem].[L_SuppKey] as [l2].[L_SuppKey]<>[TPCH].[dbo].[lineitem].[L_SuppKey] as [l1].[L_SuppKey]) ORDERED FORWARD)                                                                                                                                                                                                                                                                                                                                           1          31           9 Clustered Index Seek           Clustered Index Seek           OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C] AS [l2]), SEEK:([l2].[L_OrderKey]=[TPCH].[dbo].[lineitem].[L_OrderKey] as [l1].[L_OrderKey]),  WHERE:([TPCH].[dbo].[lineitem].[L_SuppKey] as [l2].[L_SuppKey]<>[TPCH].[dbo].[lineitem].[L_SuppKey] as [l1].[L_SuppKey]) ORDERED FORWARD                                                                                                                                    NULL                                                                                                                                                                                                                                     1.0       0.003125   1.6139897E-4          11        1108.9825 NULL                                                                                                          NULL     PLAN_ROW                                                               -1          351755.12
                                |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C] AS [l3]),  WHERE:([TPCH].[dbo].[lineitem].[L_ReceiptDate] as [l3].[L_ReceiptDate]>[TPCH].[dbo].[lineitem].[L_CommitDate] as [l3].[L_CommitDate] AND PROBE([Opt_Bitmap1142],[TPCH].[dbo].[lineitem].[L_OrderKey] as [l3].[L_OrderKey])))                                                                                                                                                                                                                                                                                                                                                 1          33           9 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C] AS [l3]),  WHERE:([TPCH].[dbo].[lineitem].[L_ReceiptDate] as [l3].[L_ReceiptDate]>[TPCH].[dbo].[lineitem].[L_CommitDate] as [l3].[L_CommitDate] AND PROBE([Opt_Bitmap1142],[TPCH].[dbo].[lineitem].[L_OrderKey] as [l3].[L_OrderKey]))                                                                                                                                     [l3].[L_OrderKey], [l3].[L_SuppKey]                                                                                                                                                                                                179958.16       768.3031      16.481207          31         784.7843 [l3].[L_OrderKey], [l3].[L_SuppKey]                                                                           NULL     PLAN_ROW                                                               -1                1.0
                                |--Clustered Index Seek(OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C] AS [l3]), SEEK:([l3].[L_OrderKey]=[TPCH].[dbo].[lineitem].[L_OrderKey] as [l1].[L_OrderKey]),  WHERE:([TPCH].[dbo].[lineitem].[L_SuppKey] as [l3].[L_SuppKey]<>[TPCH].[dbo].[lineitem].[L_SuppKey] as [l1].[L_SuppKey] AND [TPCH].[dbo].[lineitem].[L_ReceiptDate] as [l3].[L_ReceiptDate]>[TPCH].[dbo].[lineitem].[L_CommitDate] as [l3].[L_CommitDate]) ORDERED FORWARD)                                                                                                                                                                                                              1          37           7 Clustered Index Seek           Clustered Index Seek           OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C] AS [l3]), SEEK:([l3].[L_OrderKey]=[TPCH].[dbo].[lineitem].[L_OrderKey] as [l1].[L_OrderKey]),  WHERE:([TPCH].[dbo].[lineitem].[L_SuppKey] as [l3].[L_SuppKey]<>[TPCH].[dbo].[lineitem].[L_SuppKey] as [l1].[L_SuppKey] AND [TPCH].[dbo].[lineitem].[L_ReceiptDate] as [l3].[L_ReceiptDate]>[TPCH].[dbo].[lineitem].[L_CommitDate] as [l3].[L_CommitDate]) ORDERED FORWARD  NULL                                                                                                                                                                                                                                     1.0       0.003125   1.6139897E-4          27        1108.9825 NULL                                                                                                          NULL     PLAN_ROW                                                               -1          351755.12

(20 rows affected)
