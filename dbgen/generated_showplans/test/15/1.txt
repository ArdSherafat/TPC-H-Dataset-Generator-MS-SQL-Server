StmtText                                                                                                                                                                                                                                                               StmtId      NodeId      Parent      PhysicalOp                     LogicalOp                      Argument DefinedValues EstimateRows   EstimateIO     EstimateCPU    AvgRowSize  TotalSubtreeCost OutputList Warnings Type                                                             Parallel EstimateExecutions
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ----------- ----------- ----------- ------------------------------ ------------------------------ -------- ------------- -------------- -------------- -------------- ----------- ---------------- ---------- -------- ---------------------------------------------------------------- -------- ------------------

create view revenue0 (supp                                                                                                                                                                                                                                                     1           1           0 NULL                           NULL                           0        NULL                    NULL           NULL           NULL        NULL             NULL NULL       NULL     CREATE/ALTER VIEW                                                       0               NULL
lier_no, total_revenue) as
	select
		l_suppkey,
		sum(l_extendedprice * (1 - l_discount))
	from
		lineitem
	where
		l_shipdate >= cast('1996-03-01' as datetime)
		and l_shipdate < dateadd(mm, 3, cast('1996-03-01' as datetime))
	group by
		l_suppkey;              2           2           0 NULL                           NULL                           0        NULL                    NULL           NULL           NULL        NULL             NULL NULL       NULL     CREATE/ALTER VIEW                                                       0               NULL

(2 rows affected)
StmtText                                                                                                                                                                                                                                                                             StmtId      NodeId      Parent      PhysicalOp                     LogicalOp                      Argument                                                                                                                                                                                           DefinedValues                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   EstimateRows   EstimateIO     EstimateCPU    AvgRowSize  TotalSubtreeCost OutputList                                                                                                                                                 Warnings Type                                                             Parallel EstimateExecutions
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ ----------- ----------- ----------- ------------------------------ ------------------------------ -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------- -------------- -------------- ----------- ---------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------- -------- ---------------------------------------------------------------- -------- ------------------

select
	s_suppkey,
	s_name,
	s_address,
	s_phone,
	total_revenue
from
	supplier,
	revenue0
where
	s_suppkey = supplier_no
	and total_revenue = (
		select
			max(total_revenue)
		from
			revenue0
	)
order by
	s_suppkey;                                                 1           1           0 NULL                           NULL                           1                                                                                                                                                                                                  NULL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       1.0           NULL           NULL        NULL        798.74762 NULL                                                                                                                                                       NULL     SELECT                                                                  0               NULL
  |--Parallelism(Gather Streams, ORDER BY:([TPCH].[dbo].[supplier].[S_SuppKey] ASC))                                                                                                                                                                                                           1           2           1 Parallelism                    Gather Streams                 ORDER BY:([TPCH].[dbo].[supplier].[S_SuppKey] ASC)                                                                                                                                                 NULL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       1.0            0.0   2.8530568E-2         109        798.74762 [TPCH].[dbo].[supplier].[S_SuppKey], [TPCH].[dbo].[supplier].[S_Name], [TPCH].[dbo].[supplier].[S_Address], [TPCH].[dbo].[supplier].[S_Phone], [Expr1004]  NULL     PLAN_ROW                                                               -1                1.0
       |--Sort(ORDER BY:([TPCH].[dbo].[supplier].[S_SuppKey] ASC))                                                                                                                                                                                                                             1           3           2 Sort                           Sort                           ORDER BY:([TPCH].[dbo].[supplier].[S_SuppKey] ASC)                                                                                                                                                 NULL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       1.0   9.3843846E-4    2.502725E-5         109        798.71906 [TPCH].[dbo].[supplier].[S_SuppKey], [TPCH].[dbo].[supplier].[S_Name], [TPCH].[dbo].[supplier].[S_Address], [TPCH].[dbo].[supplier].[S_Phone], [Expr1004]  NULL     PLAN_ROW                                                               -1                1.0
            |--Adaptive Join                                                                                                                                                                                                                                                                   1           4           3 Adaptive Join                  Inner Join                     NULL                                                                                                                                                                                               [TPCH].[dbo].[supplier].[S_SuppKey] = ([TPCH].[dbo].[supplier].[S_SuppKey], [TPCH].[dbo].[supplier].[S_SuppKey]), [TPCH].[dbo].[supplier].[S_Name] = ([TPCH].[dbo].[supplier].[S_Name], [TPCH].[dbo].[supplier].[S_Name]), [TPCH].[dbo].[supplier].[S_Address] = ([TPCH].[dbo].[supplier].[S_Address], [TPCH].[dbo].[supplier].[S_Address]), [TPCH].[dbo].[supplier].[S_Phone] = ([TPCH].[dbo].[supplier].[S_Phone], [TPCH].[dbo].[supplier].[S_Phone]), [Expr1004] = ([Expr1004], [Expr1004])             1.0            0.0   5.0000001E-8         109        798.71808 [TPCH].[dbo].[supplier].[S_SuppKey], [TPCH].[dbo].[supplier].[S_Name], [TPCH].[dbo].[supplier].[S_Address], [TPCH].[dbo].[supplier].[S_Phone], [Expr1004]  NULL     PLAN_ROW                                                               -1                1.0
                 |--Parallelism(Distribute Streams, RoundRobin Partitioning)                                                                                                                                                                                                                   1           7           4 Parallelism                    Distribute Streams             NULL                                                                                                                                                                                               NULL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       1.0            0.0     0.02850353          28        798.71484 [TPCH].[dbo].[lineitem].[L_SuppKey], [Expr1004]                                                                                                            NULL     PLAN_ROW                                                               -1                1.0
                 |    |--Top(TOP EXPRESSION:((1)))                                                                                                                                                                                                                                             1           8           7 Top                            Top                            TOP EXPRESSION:((1)), TIE COLUMNS:([Expr1004])                                                                                                                                                     NULL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       1.0            0.0      0.0000001          28        798.68634 [TPCH].[dbo].[lineitem].[L_SuppKey], [Expr1004]                                                                                                            NULL     PLAN_ROW                                                                0                1.0
                 |         |--Parallelism(Gather Streams, ORDER BY:([Expr1004] DESC))                                                                                                                                                                                                          1           9           8 Parallelism                    Gather Streams                 ORDER BY:([Expr1004] DESC)                                                                                                                                                                         NULL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       1.0            0.0   2.8523529E-2          28        798.68634 [TPCH].[dbo].[lineitem].[L_SuppKey], [Expr1004]                                                                                                            NULL     PLAN_ROW                                                               -1                1.0
                 |              |--Sort(ORDER BY:([Expr1004] DESC))                                                                                                                                                                                                                            1          10           9 Sort                           Sort                           ORDER BY:([Expr1004] DESC)                                                                                                                                                                         NULL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       1.0   9.3843846E-4     0.16998757          28        798.65778 [TPCH].[dbo].[lineitem].[L_SuppKey], [Expr1004]                                                                                                            NULL     PLAN_ROW                                                               -1                1.0
                 |                   |--Filter(WHERE:([Expr1004] IS NOT NULL))                                                                                                                                                                                                                 1          11          10 Filter                         Filter                         WHERE:([Expr1004] IS NOT NULL)                                                                                                                                                                     NULL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 89998.211            0.0   1.1999762E-2          28        798.48688 [TPCH].[dbo].[lineitem].[L_SuppKey], [Expr1004]                                                                                                            NULL     PLAN_ROW                                                               -1                1.0
                 |                        |--Compute Scalar(DEFINE:([Expr1004]=CASE WHEN [Expr1037]=(0) THEN NULL ELSE [Expr1038] END))                                                                                                                                                        1          12          11 Compute Scalar                 Compute Scalar                 DEFINE:([Expr1004]=CASE WHEN [Expr1037]=(0) THEN NULL ELSE [Expr1038] END)                                                                                                                         [Expr1004]=CASE WHEN [Expr1037]=(0) THEN NULL ELSE [Expr1038] END                                                                                                                                                                                                                                                                                                                                                                                                                                    99998.016            0.0            0.0          28        798.47485 [TPCH].[dbo].[lineitem].[L_SuppKey], [Expr1004]                                                                                                            NULL     PLAN_ROW                                                               -1                1.0
                 |                             |--Hash Match(Aggregate, HASH:([TPCH].[dbo].[lineitem].[L_SuppKey]), RESIDUAL:([TPCH].[dbo].[lineitem].[L_SuppKey] = [TPCH].[dbo].[lineitem].[L_SuppKey]) DEFINE:([Expr1037]=COUNT_BIG([Expr1032]), [Expr1038]=SUM([Expr1032])))                1          13          12 Hash Match                     Aggregate                      HASH:([TPCH].[dbo].[lineitem].[L_SuppKey]), RESIDUAL:([TPCH].[dbo].[lineitem].[L_SuppKey] = [TPCH].[dbo].[lineitem].[L_SuppKey])                                                                   [Expr1037]=COUNT_BIG([Expr1032]), [Expr1038]=SUM([Expr1032])                                                                                                                                                                                                                                                                                                                                                                                                                                         99998.016            0.0     0.47290128          28        798.47485 [TPCH].[dbo].[lineitem].[L_SuppKey], [Expr1037], [Expr1038]                                                                                                NULL     PLAN_ROW                                                               -1                1.0
                 |                                  |--Compute Scalar(DEFINE:([Expr1032]=[TPCH].[dbo].[lineitem].[L_ExtendedPrice]*((1.)-[TPCH].[dbo].[lineitem].[L_Discount])))                                                                                                               1          14          13 Compute Scalar                 Compute Scalar                 DEFINE:([Expr1032]=[TPCH].[dbo].[lineitem].[L_ExtendedPrice]*((1.)-[TPCH].[dbo].[lineitem].[L_Discount]))                                                                                          [Expr1032]=[TPCH].[dbo].[lineitem].[L_ExtendedPrice]*((1.)-[TPCH].[dbo].[lineitem].[L_Discount])                                                                                                                                                                                                                                                                                                                                                                                                     2280637.8            0.0   5.7015941E-3          24        798.00195 [TPCH].[dbo].[lineitem].[L_SuppKey], [Expr1032]                                                                                                            NULL     PLAN_ROW                                                               -1                1.0
                 |                                       |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C]),  WHERE:([TPCH].[dbo].[lineitem].[L_ShipDate]>='1996-01-01 00:00:00.000' AND [TPCH].[dbo].[lineitem].[L_ShipDate]<'1996-04-01'))            1          15          14 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C]),  WHERE:([TPCH].[dbo].[lineitem].[L_ShipDate]>='1996-01-01 00:00:00.000' AND [TPCH].[dbo].[lineitem].[L_ShipDate]<'1996-04-01')  [TPCH].[dbo].[lineitem].[L_SuppKey], [TPCH].[dbo].[lineitem].[L_ExtendedPrice], [TPCH].[dbo].[lineitem].[L_Discount]                                                                                                                                                                                                                                                                                                                                                                                 2280637.8       768.3031      16.496204          37        784.79932 [TPCH].[dbo].[lineitem].[L_SuppKey], [TPCH].[dbo].[lineitem].[L_ExtendedPrice], [TPCH].[dbo].[lineitem].[L_Discount]                                       NULL     PLAN_ROW                                                               -1                1.0
                 |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[supplier].[PK__supplier__C9D8C8B7D7E219CD]),  WHERE:(PROBE([Opt_Bitmap1036],[TPCH].[dbo].[supplier].[S_SuppKey])))                                                                                                              1          17          14 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[supplier].[PK__supplier__C9D8C8B7D7E219CD]),  WHERE:(PROBE([Opt_Bitmap1036],[TPCH].[dbo].[supplier].[S_SuppKey]))                                                            [TPCH].[dbo].[supplier].[S_SuppKey], [TPCH].[dbo].[supplier].[S_Name], [TPCH].[dbo].[supplier].[S_Address], [TPCH].[dbo].[supplier].[S_Phone]                                                                                                                                                                                                                                                                                                                                                              1.0      1.4505324   2.7514249E-2          92        1.4780467 [TPCH].[dbo].[supplier].[S_SuppKey], [TPCH].[dbo].[supplier].[S_Name], [TPCH].[dbo].[supplier].[S_Address], [TPCH].[dbo].[supplier].[S_Phone]              NULL     PLAN_ROW                                                               -1                1.0
                 |--Clustered Index Seek(OBJECT:([TPCH].[dbo].[supplier].[PK__supplier__C9D8C8B7D7E219CD]), SEEK:([TPCH].[dbo].[supplier].[S_SuppKey]=[TPCH].[dbo].[lineitem].[L_SuppKey]) ORDERED FORWARD)                                                                                    1          20           4 Clustered Index Seek           Clustered Index Seek           OBJECT:([TPCH].[dbo].[supplier].[PK__supplier__C9D8C8B7D7E219CD]), SEEK:([TPCH].[dbo].[supplier].[S_SuppKey]=[TPCH].[dbo].[lineitem].[L_SuppKey]) ORDERED FORWARD                                  [TPCH].[dbo].[supplier].[S_SuppKey], [TPCH].[dbo].[supplier].[S_Name], [TPCH].[dbo].[supplier].[S_Address], [TPCH].[dbo].[supplier].[S_Phone]                                                                                                                                                                                                                                                                                                                                                              1.0       0.003125      0.0001581          92        0.0032831 [TPCH].[dbo].[supplier].[S_SuppKey], [TPCH].[dbo].[supplier].[S_Name], [TPCH].[dbo].[supplier].[S_Address], [TPCH].[dbo].[supplier].[S_Phone]              NULL     PLAN_ROW                                                               -1                1.0
drop view revenue0;                                                                                                                                                                                                                                                                            2          21           0 NULL                           NULL                           2                                                                                                                                                                                                  NULL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      NULL           NULL           NULL        NULL             NULL NULL                                                                                                                                                       NULL     DROP OBJECT                                                             0               NULL

(16 rows affected)
