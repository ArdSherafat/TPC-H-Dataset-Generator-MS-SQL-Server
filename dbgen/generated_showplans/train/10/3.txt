StmtText                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        StmtId      NodeId      Parent      PhysicalOp                     LogicalOp                      Argument                                                                                                                                                                                                                DefinedValues                                                                                                                                                                                                                                                   EstimateRows   EstimateIO     EstimateCPU    AvgRowSize  TotalSubtreeCost OutputList                                                                                                                                                                                                                                                                  Warnings Type                                                             Parallel EstimateExecutions
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ----------- ----------- ----------- ------------------------------ ------------------------------ ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------- -------------- -------------- ----------- ---------------- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------- ---------------------------------------------------------------- -------- ------------------

select
top 20
	c_custkey,
	c_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	c_acctbal,
	n_name,
	c_address,
	c_phone,
	c_comment
from
	customer,
	orders,
	lineitem,
	nation
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate >= cast('1994-03-01' as datetime)
	and o_orderdate < dateadd(mm, 3, cast('1994-03-01' as datetime))
	and l_returnflag = 'R'
	and c_nationkey = n_nationkey
group by
	c_custkey,
	c_name,
	c_acctbal,
	c_phone,
	n_name,
	c_address,
	c_comment
order by
	revenue desc;              1           1           0 NULL                           NULL                           1                                                                                                                                                                                                                       NULL                                                                                                                                                                                                                                                                      20.0           NULL           NULL        NULL        975.44995 NULL                                                                                                                                                                                                                                                                        NULL     SELECT                                                                  0               NULL
  |--Top(TOP EXPRESSION:((20)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           1           2           1 Top                            Top                            TOP EXPRESSION:((20))                                                                                                                                                                                                   NULL                                                                                                                                                                                                                                                                      20.0            0.0       0.000002         212        975.44995 [TPCH].[dbo].[customer].[C_CustKey], [TPCH].[dbo].[customer].[C_Name], [TPCH].[dbo].[customer].[C_Address], [TPCH].[dbo].[customer].[C_Phone], [TPCH].[dbo].[customer].[C_AcctBal], [TPCH].[dbo].[customer].[C_Comment], [TPCH].[dbo].[nation].[N_Name], [Expr1008]         NULL     PLAN_ROW                                                                0                1.0
       |--Parallelism(Gather Streams, ORDER BY:([Expr1008] DESC))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         1           4           2 Parallelism                    Gather Streams                 ORDER BY:([Expr1008] DESC)                                                                                                                                                                                              NULL                                                                                                                                                                                                                                                                      20.0            0.0   2.8724959E-2         212        975.44989 [TPCH].[dbo].[customer].[C_CustKey], [TPCH].[dbo].[customer].[C_Name], [TPCH].[dbo].[customer].[C_Address], [TPCH].[dbo].[customer].[C_Phone], [TPCH].[dbo].[customer].[C_AcctBal], [TPCH].[dbo].[customer].[C_Comment], [TPCH].[dbo].[nation].[N_Name], [Expr1008]         NULL     PLAN_ROW                                                               -1                1.0
            |--Nested Loops(Inner Join, OUTER REFERENCES:([TPCH].[dbo].[customer].[C_NationKey]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         1           5           4 Nested Loops                   Inner Join                     OUTER REFERENCES:([TPCH].[dbo].[customer].[C_NationKey])                                                                                                                                                                NULL                                                                                                                                                                                                                                                                      20.0            0.0     0.33160058         212         975.4212 [TPCH].[dbo].[customer].[C_CustKey], [TPCH].[dbo].[customer].[C_Name], [TPCH].[dbo].[customer].[C_Address], [TPCH].[dbo].[customer].[C_Phone], [TPCH].[dbo].[customer].[C_AcctBal], [TPCH].[dbo].[customer].[C_Comment], [TPCH].[dbo].[nation].[N_Name], [Expr1008]         NULL     PLAN_ROW                                                               -1                1.0
                 |--Nested Loops(Inner Join, OUTER REFERENCES:([TPCH].[dbo].[orders].[O_CustKey], [Expr1036]) WITH ORDERED PREFETCH)                                                                                                                                                                                                                                                                                                                                                                                                                                                      1           7           5 Nested Loops                   Inner Join                     OUTER REFERENCES:([TPCH].[dbo].[orders].[O_CustKey], [Expr1036]) WITH ORDERED PREFETCH                                                                                                                                  NULL                                                                                                                                                                                                                                                                      20.0            0.0     0.33160058         207        975.41473 [TPCH].[dbo].[customer].[C_CustKey], [TPCH].[dbo].[customer].[C_Name], [TPCH].[dbo].[customer].[C_Address], [TPCH].[dbo].[customer].[C_NationKey], [TPCH].[dbo].[customer].[C_Phone], [TPCH].[dbo].[customer].[C_AcctBal], [TPCH].[dbo].[customer].[C_Comment], [Expr1008]  NULL     PLAN_ROW                                                               -1                1.0
                 |    |--Sort(ORDER BY:([Expr1008] DESC))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 1           9           7 Sort                           Sort                           ORDER BY:([Expr1008] DESC)                                                                                                                                                                                              NULL                                                                                                                                                                                                                                                                      20.0   2.8153153E-3      6.6546402          28        975.34576 [TPCH].[dbo].[orders].[O_CustKey], [Expr1008]                                                                                                                                                                                                                               NULL     PLAN_ROW                                                               -1                1.0
                 |    |    |--Compute Scalar(DEFINE:([Expr1008]=CASE WHEN [Expr1034]=(0) THEN NULL ELSE [Expr1035] END))                                                                                                                                                                                                                                                                                                                                                                                                                                                                  1          10           9 Compute Scalar                 Compute Scalar                 DEFINE:([Expr1008]=CASE WHEN [Expr1034]=(0) THEN NULL ELSE [Expr1035] END)                                                                                                                                              [Expr1008]=CASE WHEN [Expr1034]=(0) THEN NULL ELSE [Expr1035] END                                                                                                                                                                                                    317321.12            0.0            0.0          28        968.68817 [TPCH].[dbo].[orders].[O_CustKey], [Expr1008]                                                                                                                                                                                                                               NULL     PLAN_ROW                                                               -1                1.0
                 |    |         |--Hash Match(Aggregate, HASH:([TPCH].[dbo].[orders].[O_CustKey]), RESIDUAL:([TPCH].[dbo].[orders].[O_CustKey] = [TPCH].[dbo].[orders].[O_CustKey]) DEFINE:([Expr1034]=COUNT_BIG([Expr1009]), [Expr1035]=SUM([Expr1009])))                                                                                                                                                                                                                                                                                                                                1          11          10 Hash Match                     Aggregate                      HASH:([TPCH].[dbo].[orders].[O_CustKey]), RESIDUAL:([TPCH].[dbo].[orders].[O_CustKey] = [TPCH].[dbo].[orders].[O_CustKey])                                                                                              [Expr1034]=COUNT_BIG([Expr1009]), [Expr1035]=SUM([Expr1009])                                                                                                                                                                                                         317321.12            0.0     0.31321222          28        968.68817 [TPCH].[dbo].[orders].[O_CustKey], [Expr1034], [Expr1035]                                                                                                                                                                                                                   NULL     PLAN_ROW                                                               -1                1.0
                 |    |              |--Adaptive Join                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     1          12          11 Adaptive Join                  Inner Join                     NULL                                                                                                                                                                                                                    [TPCH].[dbo].[orders].[O_CustKey] = ([TPCH].[dbo].[orders].[O_CustKey], [TPCH].[dbo].[orders].[O_CustKey]), [Expr1009] = ([Expr1009], [Expr1009])                                                                                                                    575758.31            0.0   2.8787917E-3          24        968.37781 [TPCH].[dbo].[orders].[O_CustKey], [Expr1009]                                                                                                                                                                                                                               NULL     PLAN_ROW                                                               -1                1.0
                 |    |                   |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[orders].[PK__orders__0F8A125214F3A7C2]),  WHERE:([TPCH].[dbo].[orders].[O_OrderDate]>='1994-03-01 00:00:00.000' AND [TPCH].[dbo].[orders].[O_OrderDate]<'1994-06-01 00:00:00.000'))                                                                                                                                                                                                                                                                                                               1          14          12 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[orders].[PK__orders__0F8A125214F3A7C2]),  WHERE:([TPCH].[dbo].[orders].[O_OrderDate]>='1994-03-01 00:00:00.000' AND [TPCH].[dbo].[orders].[O_OrderDate]<'1994-06-01 00:00:00.000')                [TPCH].[dbo].[orders].[O_OrderKey], [TPCH].[dbo].[orders].[O_CustKey]                                                                                                                                                                                                576854.31      168.57867      4.1250391          23        172.70372 [TPCH].[dbo].[orders].[O_OrderKey], [TPCH].[dbo].[orders].[O_CustKey]                                                                                                                                                                                                       NULL     PLAN_ROW                                                               -1                1.0
                 |    |                   |--Compute Scalar(DEFINE:([Expr1009]=[TPCH].[dbo].[lineitem].[L_ExtendedPrice]*((1.)-[TPCH].[dbo].[lineitem].[L_Discount])))                                                                                                                                                                                                                                                                                                                                                                                                                    1          15          12 Compute Scalar                 Compute Scalar                 DEFINE:([Expr1009]=[TPCH].[dbo].[lineitem].[L_ExtendedPrice]*((1.)-[TPCH].[dbo].[lineitem].[L_Discount]))                                                                                                               [Expr1009]=[TPCH].[dbo].[lineitem].[L_ExtendedPrice]*((1.)-[TPCH].[dbo].[lineitem].[L_Discount])                                                                                                                                                                     1497150.1            0.0   3.7428753E-3          24        791.98639 [TPCH].[dbo].[lineitem].[L_OrderKey], [Expr1009]                                                                                                                                                                                                                            NULL     PLAN_ROW                                                               -1                1.0
                 |    |                   |    |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C]),  WHERE:([TPCH].[dbo].[lineitem].[L_ReturnFlag]='R' AND PROBE([Opt_Bitmap1026],[TPCH].[dbo].[lineitem].[L_OrderKey])))                                                                                                                                                                                                                                                                                                                           1          17          15 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C]),  WHERE:([TPCH].[dbo].[lineitem].[L_ReturnFlag]='R' AND PROBE([Opt_Bitmap1026],[TPCH].[dbo].[lineitem].[L_OrderKey]))                                 [TPCH].[dbo].[lineitem].[L_OrderKey], [TPCH].[dbo].[lineitem].[L_ExtendedPrice], [TPCH].[dbo].[lineitem].[L_Discount]                                                                                                                                                1497150.1       768.3031      16.481207          34         784.7843 [TPCH].[dbo].[lineitem].[L_OrderKey], [TPCH].[dbo].[lineitem].[L_ExtendedPrice], [TPCH].[dbo].[lineitem].[L_Discount]                                                                                                                                                       NULL     PLAN_ROW                                                               -1                1.0
                 |    |                   |--Compute Scalar(DEFINE:([Expr1009]=[TPCH].[dbo].[lineitem].[L_ExtendedPrice]*((1.)-[TPCH].[dbo].[lineitem].[L_Discount])))                                                                                                                                                                                                                                                                                                                                                                                                                    1          18          12 Compute Scalar                 Compute Scalar                 DEFINE:([Expr1009]=[TPCH].[dbo].[lineitem].[L_ExtendedPrice]*((1.)-[TPCH].[dbo].[lineitem].[L_Discount]))                                                                                                               [Expr1009]=[TPCH].[dbo].[lineitem].[L_ExtendedPrice]*((1.)-[TPCH].[dbo].[lineitem].[L_Discount])                                                                                                                                                                     575758.31            0.0   1.4393958E-2          24        975.44995 [TPCH].[dbo].[orders].[O_CustKey], [Expr1009]                                                                                                                                                                                                                               NULL     PLAN_ROW                                                               -1                1.0
                 |    |                        |--Clustered Index Seek(OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C]), SEEK:([TPCH].[dbo].[lineitem].[L_OrderKey]=[TPCH].[dbo].[orders].[O_OrderKey]),  WHERE:([TPCH].[dbo].[lineitem].[L_ReturnFlag]='R') ORDERED FORWARD)                                                                                                                                                                                                                                                                                            1          21          18 Clustered Index Seek           Clustered Index Seek           OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C]), SEEK:([TPCH].[dbo].[lineitem].[L_OrderKey]=[TPCH].[dbo].[orders].[O_OrderKey]),  WHERE:([TPCH].[dbo].[lineitem].[L_ReturnFlag]='R') ORDERED FORWARD  [TPCH].[dbo].[lineitem].[L_ExtendedPrice], [TPCH].[dbo].[lineitem].[L_Discount]                                                                                                                                                                                            1.0       0.003125   1.6139897E-4          30        975.44995 [TPCH].[dbo].[lineitem].[L_ExtendedPrice], [TPCH].[dbo].[lineitem].[L_Discount]                                                                                                                                                                                             NULL     PLAN_ROW                                                               -1          576854.31
                 |    |--Clustered Index Seek(OBJECT:([TPCH].[dbo].[customer].[PK__customer__48695B71963F6D86]), SEEK:([TPCH].[dbo].[customer].[C_CustKey]=[TPCH].[dbo].[orders].[O_CustKey]) ORDERED FORWARD)                                                                                                                                                                                                                                                                                                                                                                            1          22           7 Clustered Index Seek           Clustered Index Seek           OBJECT:([TPCH].[dbo].[customer].[PK__customer__48695B71963F6D86]), SEEK:([TPCH].[dbo].[customer].[C_CustKey]=[TPCH].[dbo].[orders].[O_CustKey]) ORDERED FORWARD                                                         [TPCH].[dbo].[customer].[C_CustKey], [TPCH].[dbo].[customer].[C_Name], [TPCH].[dbo].[customer].[C_Address], [TPCH].[dbo].[customer].[C_NationKey], [TPCH].[dbo].[customer].[C_Phone], [TPCH].[dbo].[customer].[C_AcctBal], [TPCH].[dbo].[customer].[C_Comment]             1.0       0.003125      0.0001581         190     6.8923391E-2 [TPCH].[dbo].[customer].[C_CustKey], [TPCH].[dbo].[customer].[C_Name], [TPCH].[dbo].[customer].[C_Address], [TPCH].[dbo].[customer].[C_NationKey], [TPCH].[dbo].[customer].[C_Phone], [TPCH].[dbo].[customer].[C_AcctBal], [TPCH].[dbo].[customer].[C_Comment]              NULL     PLAN_ROW                                                               -1          20.999992
                 |--Clustered Index Seek(OBJECT:([TPCH].[dbo].[nation].[PK__nation__BD3779521509254A]), SEEK:([TPCH].[dbo].[nation].[N_NationKey]=[TPCH].[dbo].[customer].[C_NationKey]) ORDERED FORWARD)                                                                                                                                                                                                                                                                                                                                                                                 1          23           5 Clustered Index Seek           Clustered Index Seek           OBJECT:([TPCH].[dbo].[nation].[PK__nation__BD3779521509254A]), SEEK:([TPCH].[dbo].[nation].[N_NationKey]=[TPCH].[dbo].[customer].[C_NationKey]) ORDERED FORWARD                                                         [TPCH].[dbo].[nation].[N_Name]                                                                                                                                                                                                                                             1.0       0.003125      0.0001581          18     6.4451089E-3 [TPCH].[dbo].[nation].[N_Name]                                                                                                                                                                                                                                              NULL     PLAN_ROW                                                               -1          21.000055

(16 rows affected)
