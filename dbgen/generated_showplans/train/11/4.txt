StmtText                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         StmtId      NodeId      Parent      PhysicalOp                     LogicalOp                      Argument                                                                                                                                                                  DefinedValues                                                                                                                                               EstimateRows   EstimateIO     EstimateCPU    AvgRowSize  TotalSubtreeCost OutputList                                                                                                                                                  Warnings Type                                                             Parallel EstimateExecutions
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ----------- ----------- ----------- ------------------------------ ------------------------------ ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------------------------------------------------------------------------------------------------------------------------- -------------- -------------- -------------- ----------- ---------------- ----------------------------------------------------------------------------------------------------------------------------------------------------------- -------- ---------------------------------------------------------------- -------- ------------------

select
	ps_partkey,
	sum(ps_supplycost * ps_availqty) as value
from
	partsupp,
	supplier,
	nation
where
	ps_suppkey = s_suppkey
	and s_nationkey = n_nationkey
	and n_name = 'ALGERIA'
group by
	ps_partkey having
		sum(ps_supplycost * ps_availqty) > (
			select
				sum(ps_supplycost * ps_availqty) * 0.0001000000
			from
				partsupp,
				supplier,
				nation
			where
				ps_suppkey = s_suppkey
				and s_nationkey = n_nationkey
				and n_name = 'ALGERIA'
		)
order by
	value desc;              1           1           0 NULL                           NULL                           1                                                                                                                                                                         NULL                                                                                                                                                             91062.898           NULL           NULL        NULL         242.0428 NULL                                                                                                                                                        NULL     SELECT                                                                  0               NULL
  |--Parallelism(Gather Streams, ORDER BY:([Expr1006] DESC))                                                                                                                                                                                                                                                                                                                                                                                                                                                                               1           2           1 Parallelism                    Gather Streams                 ORDER BY:([Expr1006] DESC)                                                                                                                                                NULL                                                                                                                                                             91062.898            0.0     0.56416613          28         242.0428 [TPCH].[dbo].[partsupp].[PS_PartKey], [Expr1006]                                                                                                            NULL     PLAN_ROW                                                               -1                1.0
       |--Sort(ORDER BY:([Expr1006] DESC))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 1           3           2 Sort                           Sort                           ORDER BY:([Expr1006] DESC)                                                                                                                                                NULL                                                                                                                                                             91062.898   9.3843846E-4     0.17217556          28        241.47859 [TPCH].[dbo].[partsupp].[PS_PartKey], [Expr1006]                                                                                                            NULL     PLAN_ROW                                                               -1                1.0
            |--Nested Loops(Inner Join, WHERE:([Expr1006]>[Expr1013]*(0.0001000000)))                                                                                                                                                                                                                                                                                                                                                                                                                                                      1           4           3 Nested Loops                   Inner Join                     WHERE:([Expr1006]>[Expr1013]*(0.0001000000))                                                                                                                              NULL                                                                                                                                                             91062.898            0.0     0.31720242          28        241.29633 [TPCH].[dbo].[partsupp].[PS_PartKey], [Expr1006]                                                                                                            NULL     PLAN_ROW                                                               -1                1.0
                 |--Parallelism(Distribute Streams, Broadcast Partitioning)                                                                                                                                                                                                                                                                                                                                                                                                                                                                1           6           4 Parallelism                    Distribute Streams             NULL                                                                                                                                                                      NULL                                                                                                                                                                   1.0            0.0     0.02850277          24         120.3476 [Expr1013]                                                                                                                                                  NULL     PLAN_ROW                                                               -1                1.0
                 |    |--Compute Scalar(DEFINE:([Expr1013]=CASE WHEN [globalagg1024]=(0) THEN NULL ELSE [globalagg1026] END))                                                                                                                                                                                                                                                                                                                                                                                                              1           7           6 Compute Scalar                 Compute Scalar                 DEFINE:([Expr1013]=CASE WHEN [globalagg1024]=(0) THEN NULL ELSE [globalagg1026] END)                                                                                      [Expr1013]=CASE WHEN [globalagg1024]=(0) THEN NULL ELSE [globalagg1026] END                                                                                            1.0            0.0      0.0000001          24        120.31909 [Expr1013]                                                                                                                                                  NULL     PLAN_ROW                                                                0                1.0
                 |         |--Parallelism(Gather Streams)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  1           8           7 Parallelism                    Gather Streams                 NULL                                                                                                                                                                      NULL                                                                                                                                                                   1.0            0.0   2.8503805E-2          32        120.31909 [globalagg1024], [globalagg1026]                                                                                                                            NULL     PLAN_ROW                                                               -1                1.0
                 |              |--Hash Match(Aggregate, HASH:() DEFINE:([globalagg1024]=SUM([partialagg1023]), [globalagg1026]=SUM([partialagg1025])))                                                                                                                                                                                                                                                                                                                                                                                    1           9           8 Hash Match                     Aggregate                      HASH:()                                                                                                                                                                   [globalagg1024]=SUM([partialagg1023]), [globalagg1026]=SUM([partialagg1025])                                                                                           1.0            0.0   1.8150766E-3          32        120.29059 [globalagg1024], [globalagg1026]                                                                                                                            NULL     PLAN_ROW                                                               -1                1.0
                 |                   |--Hash Match(Inner Join, HASH:([TPCH].[dbo].[supplier].[S_SuppKey])=([TPCH].[dbo].[partsupp].[PS_SuppKey])DEFINE:([Opt_Bitmap1046]))                                                                                                                                                                                                                                                                                                                                                                 1          10           9 Hash Match                     Inner Join                     HASH:([TPCH].[dbo].[supplier].[S_SuppKey])=([TPCH].[dbo].[partsupp].[PS_SuppKey])                                                                                         [Opt_Bitmap1046]                                                                                                                                                    4000.0            0.0    4.191183E-3          32        120.28877 [partialagg1023], [partialagg1025]                                                                                                                          NULL     PLAN_ROW                                                               -1                1.0
                 |                        |--Hash Match(Inner Join, HASH:([TPCH].[dbo].[nation].[N_NationKey])=([TPCH].[dbo].[supplier].[S_NationKey]), RESIDUAL:([TPCH].[dbo].[supplier].[S_NationKey]=[TPCH].[dbo].[nation].[N_NationKey])DEFINE:([Opt_Bitmap1043]))                                                                                                                                                                                                                                                                     1          11          10 Hash Match                     Inner Join                     HASH:([TPCH].[dbo].[nation].[N_NationKey])=([TPCH].[dbo].[supplier].[S_NationKey]), RESIDUAL:([TPCH].[dbo].[supplier].[S_NationKey]=[TPCH].[dbo].[nation].[N_NationKey])  [Opt_Bitmap1043]                                                                                                                                                    4000.0            0.0   3.2253938E-3          11        1.4844491 [TPCH].[dbo].[supplier].[S_SuppKey]                                                                                                                         NULL     PLAN_ROW                                                               -1                1.0
                 |                        |    |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[nation].[PK__nation__BD3779521509254A]),  WHERE:([TPCH].[dbo].[nation].[N_Name]='ALGERIA'))                                                                                                                                                                                                                                                                                                                                                   1          12          11 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[nation].[PK__nation__BD3779521509254A]),  WHERE:([TPCH].[dbo].[nation].[N_Name]='ALGERIA')                                                          [TPCH].[dbo].[nation].[N_NationKey]                                                                                                                                    1.0       0.003125   4.6124998E-5          47      3.171125E-3 [TPCH].[dbo].[nation].[N_NationKey]                                                                                                                         NULL     PLAN_ROW                                                               -1                1.0
                 |                        |    |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[supplier].[PK__supplier__C9D8C8B7D7E219CD]),  WHERE:(PROBE([Opt_Bitmap1043],[TPCH].[dbo].[supplier].[S_NationKey])))                                                                                                                                                                                                                                                                                                                          1          14          11 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[supplier].[PK__supplier__C9D8C8B7D7E219CD]),  WHERE:(PROBE([Opt_Bitmap1043],[TPCH].[dbo].[supplier].[S_NationKey]))                                 [TPCH].[dbo].[supplier].[S_SuppKey], [TPCH].[dbo].[supplier].[S_NationKey]                                                                                         10000.0      1.4505324   2.7514249E-2          15        1.4780467 [TPCH].[dbo].[supplier].[S_SuppKey], [TPCH].[dbo].[supplier].[S_NationKey]                                                                                  NULL     PLAN_ROW                                                               -1                1.0
                 |                        |--Hash Match(Aggregate, HASH:([TPCH].[dbo].[partsupp].[PS_SuppKey]) DEFINE:([partialagg1023]=COUNT_BIG([Expr1016]), [partialagg1025]=SUM([Expr1016])))                                                                                                                                                                                                                                                                                                                                          1          15          10 Hash Match                     Aggregate                      HASH:([TPCH].[dbo].[partsupp].[PS_SuppKey])                                                                                                                               [partialagg1023]=COUNT_BIG([Expr1016]), [partialagg1025]=SUM([Expr1016])                                                                                         9921.5996            0.0     0.10585233          36        118.80013 [TPCH].[dbo].[partsupp].[PS_SuppKey], [partialagg1023], [partialagg1025]                                                                                    NULL     PLAN_ROW                                                               -1                1.0
                 |                             |--Compute Scalar(DEFINE:([Expr1016]=[TPCH].[dbo].[partsupp].[PS_SupplyCost]*CONVERT_IMPLICIT(decimal(10,0),[TPCH].[dbo].[partsupp].[PS_AvailQty],0)))                                                                                                                                                                                                                                                                                                                                      1          16          15 Compute Scalar                 Compute Scalar                 DEFINE:([Expr1016]=[TPCH].[dbo].[partsupp].[PS_SupplyCost]*CONVERT_IMPLICIT(decimal(10,0),[TPCH].[dbo].[partsupp].[PS_AvailQty],0))                                       [Expr1016]=[TPCH].[dbo].[partsupp].[PS_SupplyCost]*CONVERT_IMPLICIT(decimal(10,0),[TPCH].[dbo].[partsupp].[PS_AvailQty],0)                                        800000.0            0.0   2.0000001E-3          24        118.69427 [TPCH].[dbo].[partsupp].[PS_SuppKey], [Expr1016]                                                                                                            NULL     PLAN_ROW                                                               -1                1.0
                 |                                  |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[partsupp].[PK__partsupp__087C85AD76D78946]),  WHERE:(PROBE([Opt_Bitmap1046],[TPCH].[dbo].[partsupp].[PS_SuppKey])))                                                                                                                                                                                                                                                                                                                      1          18          16 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[partsupp].[PK__partsupp__087C85AD76D78946]),  WHERE:(PROBE([Opt_Bitmap1046],[TPCH].[dbo].[partsupp].[PS_SuppKey]))                                  [TPCH].[dbo].[partsupp].[PS_SuppKey], [TPCH].[dbo].[partsupp].[PS_AvailQty], [TPCH].[dbo].[partsupp].[PS_SupplyCost]                                              800000.0      116.49424      2.1980393          24        118.69228 [TPCH].[dbo].[partsupp].[PS_SuppKey], [TPCH].[dbo].[partsupp].[PS_AvailQty], [TPCH].[dbo].[partsupp].[PS_SupplyCost]                                        NULL     PLAN_ROW                                                               -1                1.0
                 |--Compute Scalar(DEFINE:([Expr1006]=CASE WHEN [Expr1051]=(0) THEN NULL ELSE [Expr1052] END))                                                                                                                                                                                                                                                                                                                                                                                                                             1          19           4 Compute Scalar                 Compute Scalar                 DEFINE:([Expr1006]=CASE WHEN [Expr1051]=(0) THEN NULL ELSE [Expr1052] END)                                                                                                [Expr1006]=CASE WHEN [Expr1051]=(0) THEN NULL ELSE [Expr1052] END                                                                                                 303543.0            0.0            0.0          28        120.47961 [TPCH].[dbo].[partsupp].[PS_PartKey], [Expr1006]                                                                                                            NULL     PLAN_ROW                                                               -1                1.0
                      |--Hash Match(Aggregate, HASH:([TPCH].[dbo].[partsupp].[PS_PartKey]) DEFINE:([Expr1051]=COUNT_BIG([Expr1015]), [Expr1052]=SUM([Expr1015])))                                                                                                                                                                                                                                                                                                                                                                          1          20          19 Hash Match                     Aggregate                      HASH:([TPCH].[dbo].[partsupp].[PS_PartKey])                                                                                                                               [Expr1051]=COUNT_BIG([Expr1015]), [Expr1052]=SUM([Expr1015])                                                                                                      303543.0            0.0     0.18192905          28        120.47961 [TPCH].[dbo].[partsupp].[PS_PartKey], [Expr1051], [Expr1052]                                                                                                NULL     PLAN_ROW                                                               -1                1.0
                           |--Hash Match(Inner Join, HASH:([TPCH].[dbo].[supplier].[S_SuppKey])=([TPCH].[dbo].[partsupp].[PS_SuppKey])DEFINE:([Opt_Bitmap1042]))                                                                                                                                                                                                                                                                                                                                                                           1          21          20 Hash Match                     Inner Join                     HASH:([TPCH].[dbo].[supplier].[S_SuppKey])=([TPCH].[dbo].[partsupp].[PS_SuppKey])                                                                                         [Opt_Bitmap1042]                                                                                                                                                 322528.62            0.0     0.11895569          24        120.29768 [TPCH].[dbo].[partsupp].[PS_PartKey], [Expr1015]                                                                                                            NULL     PLAN_ROW                                                               -1                1.0
                                |--Hash Match(Inner Join, HASH:([TPCH].[dbo].[nation].[N_NationKey])=([TPCH].[dbo].[supplier].[S_NationKey]), RESIDUAL:([TPCH].[dbo].[supplier].[S_NationKey]=[TPCH].[dbo].[nation].[N_NationKey])DEFINE:([Opt_Bitmap1039]))                                                                                                                                                                                                                                                                               1          22          21 Hash Match                     Inner Join                     HASH:([TPCH].[dbo].[nation].[N_NationKey])=([TPCH].[dbo].[supplier].[S_NationKey]), RESIDUAL:([TPCH].[dbo].[supplier].[S_NationKey]=[TPCH].[dbo].[nation].[N_NationKey])  [Opt_Bitmap1039]                                                                                                                                                    4000.0            0.0   3.2253938E-3          11        1.4844491 [TPCH].[dbo].[supplier].[S_SuppKey]                                                                                                                         NULL     PLAN_ROW                                                               -1                1.0
                                |    |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[nation].[PK__nation__BD3779521509254A]),  WHERE:([TPCH].[dbo].[nation].[N_Name]='ALGERIA'))                                                                                                                                                                                                                                                                                                                                                             1          23          22 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[nation].[PK__nation__BD3779521509254A]),  WHERE:([TPCH].[dbo].[nation].[N_Name]='ALGERIA')                                                          [TPCH].[dbo].[nation].[N_NationKey]                                                                                                                                    1.0       0.003125   4.6124998E-5          22      3.171125E-3 [TPCH].[dbo].[nation].[N_NationKey]                                                                                                                         NULL     PLAN_ROW                                                               -1                1.0
                                |    |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[supplier].[PK__supplier__C9D8C8B7D7E219CD]),  WHERE:(PROBE([Opt_Bitmap1039],[TPCH].[dbo].[supplier].[S_NationKey])))                                                                                                                                                                                                                                                                                                                                    1          25          22 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[supplier].[PK__supplier__C9D8C8B7D7E219CD]),  WHERE:(PROBE([Opt_Bitmap1039],[TPCH].[dbo].[supplier].[S_NationKey]))                                 [TPCH].[dbo].[supplier].[S_SuppKey], [TPCH].[dbo].[supplier].[S_NationKey]                                                                                         10000.0      1.4505324   2.7514249E-2          15        1.4780467 [TPCH].[dbo].[supplier].[S_SuppKey], [TPCH].[dbo].[supplier].[S_NationKey]                                                                                  NULL     PLAN_ROW                                                               -1                1.0
                                |--Compute Scalar(DEFINE:([Expr1015]=[TPCH].[dbo].[partsupp].[PS_SupplyCost]*CONVERT_IMPLICIT(decimal(10,0),[TPCH].[dbo].[partsupp].[PS_AvailQty],0)))                                                                                                                                                                                                                                                                                                                                                     1          26          21 Compute Scalar                 Compute Scalar                 DEFINE:([Expr1015]=[TPCH].[dbo].[partsupp].[PS_SupplyCost]*CONVERT_IMPLICIT(decimal(10,0),[TPCH].[dbo].[partsupp].[PS_AvailQty],0))                                       [Expr1015]=[TPCH].[dbo].[partsupp].[PS_SupplyCost]*CONVERT_IMPLICIT(decimal(10,0),[TPCH].[dbo].[partsupp].[PS_AvailQty],0)                                        800000.0            0.0   2.0000001E-3          28        118.69427 [TPCH].[dbo].[partsupp].[PS_PartKey], [TPCH].[dbo].[partsupp].[PS_SuppKey], [Expr1015]                                                                      NULL     PLAN_ROW                                                               -1                1.0
                                     |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[partsupp].[PK__partsupp__087C85AD76D78946]),  WHERE:(PROBE([Opt_Bitmap1042],[TPCH].[dbo].[partsupp].[PS_SuppKey])))                                                                                                                                                                                                                                                                                                                                     1          28          26 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[partsupp].[PK__partsupp__087C85AD76D78946]),  WHERE:(PROBE([Opt_Bitmap1042],[TPCH].[dbo].[partsupp].[PS_SuppKey]))                                  [TPCH].[dbo].[partsupp].[PS_PartKey], [TPCH].[dbo].[partsupp].[PS_SuppKey], [TPCH].[dbo].[partsupp].[PS_AvailQty], [TPCH].[dbo].[partsupp].[PS_SupplyCost]        800000.0      116.49424      2.1980393          28        118.69228 [TPCH].[dbo].[partsupp].[PS_PartKey], [TPCH].[dbo].[partsupp].[PS_SuppKey], [TPCH].[dbo].[partsupp].[PS_AvailQty], [TPCH].[dbo].[partsupp].[PS_SupplyCost]  NULL     PLAN_ROW                                                               -1                1.0

(23 rows affected)
