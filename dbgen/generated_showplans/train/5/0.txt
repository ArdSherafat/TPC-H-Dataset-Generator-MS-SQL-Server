StmtText                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             StmtId      NodeId      Parent      PhysicalOp                     LogicalOp                      Argument                                                                                                                                                                                                                                                                                                                        DefinedValues                                                                                                         EstimateRows   EstimateIO     EstimateCPU    AvgRowSize  TotalSubtreeCost OutputList                                                                                                                                                 Warnings Type                                                             Parallel EstimateExecutions
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ ----------- ----------- ----------- ------------------------------ ------------------------------ ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------------------------------------------------------------------------------------------- -------------- -------------- -------------- ----------- ---------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------- -------- ---------------------------------------------------------------- -------- ------------------

select
	n_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue
from
	customer,
	orders,
	lineitem,
	supplier,
	nation,
	region
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and l_suppkey = s_suppkey
	and c_nationkey = s_nationkey
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'ASIA'
	and o_orderdate >= cast('1997-01-01' as datetime)
	and o_orderdate < dateadd(yy, 1, cast('1997-01-01' as datetime))
group by
	n_name
order by
	revenue desc;              1           1           0 NULL                           NULL                           1                                                                                                                                                                                                                                                                                                                               NULL                                                                                                                             5.0           NULL           NULL        NULL        873.24835 NULL                                                                                                                                                       NULL     SELECT                                                                  0               NULL
  |--Parallelism(Gather Streams, ORDER BY:([Expr1012] DESC))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   1           2           1 Parallelism                    Gather Streams                 ORDER BY:([Expr1012] DESC)                                                                                                                                                                                                                                                                                                      NULL                                                                                                                             5.0            0.0   2.8530017E-2          35        873.24835 [TPCH].[dbo].[nation].[N_Name], [Expr1012]                                                                                                                 NULL     PLAN_ROW                                                               -1                1.0
       |--Sort(ORDER BY:([Expr1012] DESC))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     1           3           2 Sort                           Sort                           ORDER BY:([Expr1012] DESC)                                                                                                                                                                                                                                                                                                      NULL                                                                                                                             5.0   9.3843846E-4   2.5461526E-5          35        873.21979 [TPCH].[dbo].[nation].[N_Name], [Expr1012]                                                                                                                 NULL     PLAN_ROW                                                               -1                1.0
            |--Compute Scalar(DEFINE:([Expr1012]=CASE WHEN [globalagg1022]=(0) THEN NULL ELSE [globalagg1024] END))                                                                                                                                                                                                                                                                                                                                                                                                                            1           5           3 Compute Scalar                 Compute Scalar                 DEFINE:([Expr1012]=CASE WHEN [globalagg1022]=(0) THEN NULL ELSE [globalagg1024] END)                                                                                                                                                                                                                                            [Expr1012]=CASE WHEN [globalagg1022]=(0) THEN NULL ELSE [globalagg1024] END                                                      5.0            0.0        1.25E-8          35        873.21887 [TPCH].[dbo].[nation].[N_Name], [Expr1012]                                                                                                                 NULL     PLAN_ROW                                                               -1                1.0
                 |--Hash Match(Aggregate, HASH:([TPCH].[dbo].[nation].[N_Name]), RESIDUAL:([TPCH].[dbo].[nation].[N_Name] = [TPCH].[dbo].[nation].[N_Name]) DEFINE:([globalagg1022]=SUM([partialagg1021]), [globalagg1024]=SUM([partialagg1023])))                                                                                                                                                                                                                                                                                             1           6           5 Hash Match                     Aggregate                      HASH:([TPCH].[dbo].[nation].[N_Name]), RESIDUAL:([TPCH].[dbo].[nation].[N_Name] = [TPCH].[dbo].[nation].[N_Name])                                                                                                                                                                                                               [globalagg1022]=SUM([partialagg1021]), [globalagg1024]=SUM([partialagg1023])                                                     5.0            0.0   1.7828766E-3          43        873.21887 [TPCH].[dbo].[nation].[N_Name], [globalagg1022], [globalagg1024]                                                                                           NULL     PLAN_ROW                                                               -1                1.0
                      |--Hash Match(Inner Join, HASH:([TPCH].[dbo].[region].[R_RegionKey])=([TPCH].[dbo].[nation].[N_RegionKey]), RESIDUAL:([TPCH].[dbo].[nation].[N_RegionKey]=[TPCH].[dbo].[region].[R_RegionKey])DEFINE:([Opt_Bitmap1173]))                                                                                                                                                                                                                                                                                                 1           7           6 Hash Match                     Inner Join                     HASH:([TPCH].[dbo].[region].[R_RegionKey])=([TPCH].[dbo].[nation].[N_RegionKey]), RESIDUAL:([TPCH].[dbo].[nation].[N_RegionKey]=[TPCH].[dbo].[region].[R_RegionKey])                                                                                                                                                            [Opt_Bitmap1173]                                                                                                                 5.0            0.0   1.7759237E-3          43        873.21704 [TPCH].[dbo].[nation].[N_Name], [partialagg1021], [partialagg1023]                                                                                         NULL     PLAN_ROW                                                               -1                1.0
                           |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[region].[PK__region__D23875B3C12BD19D]),  WHERE:([TPCH].[dbo].[region].[R_Name]='ASIA'))                                                                                                                                                                                                                                                                                                                                                                              1           8           7 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[region].[PK__region__D23875B3C12BD19D]),  WHERE:([TPCH].[dbo].[region].[R_Name]='ASIA')                                                                                                                                                                                                                   [TPCH].[dbo].[region].[R_RegionKey]                                                                                              1.0       0.003125      4.0625E-5          21      3.165625E-3 [TPCH].[dbo].[region].[R_RegionKey]                                                                                                                        NULL     PLAN_ROW                                                               -1                1.0
                           |--Hash Match(Aggregate, HASH:([TPCH].[dbo].[nation].[N_Name], [TPCH].[dbo].[nation].[N_RegionKey]), RESIDUAL:([TPCH].[dbo].[nation].[N_Name] = [TPCH].[dbo].[nation].[N_Name] AND [TPCH].[dbo].[nation].[N_RegionKey] = [TPCH].[dbo].[nation].[N_RegionKey]) DEFINE:([partialagg1021]=COUNT_BIG([Expr1013]), [partialagg1023]=SUM([Expr1013])))                                                                                                                                                                    1           9           7 Hash Match                     Aggregate                      HASH:([TPCH].[dbo].[nation].[N_Name], [TPCH].[dbo].[nation].[N_RegionKey]), RESIDUAL:([TPCH].[dbo].[nation].[N_Name] = [TPCH].[dbo].[nation].[N_Name] AND [TPCH].[dbo].[nation].[N_RegionKey] = [TPCH].[dbo].[nation].[N_RegionKey])                                                                                            [partialagg1021]=COUNT_BIG([Expr1013]), [partialagg1023]=SUM([Expr1013])                                                         2.5            0.0   8.1785927E-3          47         873.2121 [TPCH].[dbo].[nation].[N_Name], [TPCH].[dbo].[nation].[N_RegionKey], [partialagg1021], [partialagg1023]                                                    NULL     PLAN_ROW                                                               -1                1.0
                                |--Hash Match(Inner Join, HASH:([TPCH].[dbo].[supplier].[S_NationKey], [TPCH].[dbo].[supplier].[S_SuppKey])=([TPCH].[dbo].[nation].[N_NationKey], [TPCH].[dbo].[lineitem].[L_SuppKey]), RESIDUAL:([TPCH].[dbo].[supplier].[S_NationKey]=[TPCH].[dbo].[nation].[N_NationKey] AND [TPCH].[dbo].[lineitem].[L_SuppKey]=[TPCH].[dbo].[supplier].[S_SuppKey])DEFINE:([Opt_Bitmap1176]))                                                                                                                             1          10           9 Hash Match                     Inner Join                     HASH:([TPCH].[dbo].[supplier].[S_NationKey], [TPCH].[dbo].[supplier].[S_SuppKey])=([TPCH].[dbo].[nation].[N_NationKey], [TPCH].[dbo].[lineitem].[L_SuppKey]), RESIDUAL:([TPCH].[dbo].[supplier].[S_NationKey]=[TPCH].[dbo].[nation].[N_NationKey] AND [TPCH].[dbo].[lineitem].[L_SuppKey]=[TPCH].[dbo].[supplier].[S_SuppKey])  [Opt_Bitmap1176]                                                                                                           36021.738            0.0     0.14063287          35        873.20392 [TPCH].[dbo].[nation].[N_Name], [TPCH].[dbo].[nation].[N_RegionKey], [Expr1013]                                                                            NULL     PLAN_ROW                                                               -1                1.0
                                     |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[supplier].[PK__supplier__C9D8C8B7D7E219CD]))                                                                                                                                                                                                                                                                                                                                                                                                                1          11          10 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[supplier].[PK__supplier__C9D8C8B7D7E219CD])                                                                                                                                                                                                                                                               [TPCH].[dbo].[supplier].[S_SuppKey], [TPCH].[dbo].[supplier].[S_NationKey]                                                  100000.0      1.4505324     0.02753925          15        1.4780717 [TPCH].[dbo].[supplier].[S_SuppKey], [TPCH].[dbo].[supplier].[S_NationKey]                                                                                 NULL     PLAN_ROW                                                               -1                1.0
                                     |--Filter(WHERE:(PROBE([Opt_Bitmap1176],[TPCH].[dbo].[nation].[N_NationKey],[TPCH].[dbo].[lineitem].[L_SuppKey])))                                                                                                                                                                                                                                                                                                                                                                                        1          12          10 Filter                         Filter                         WHERE:(PROBE([Opt_Bitmap1176],[TPCH].[dbo].[nation].[N_NationKey],[TPCH].[dbo].[lineitem].[L_SuppKey]))                                                                                                                                                                                                                         NULL                                                                                                                       900534.19            0.0     0.17375618          43        871.58521 [TPCH].[dbo].[lineitem].[L_SuppKey], [TPCH].[dbo].[nation].[N_NationKey], [TPCH].[dbo].[nation].[N_Name], [TPCH].[dbo].[nation].[N_RegionKey], [Expr1013]  NULL     PLAN_ROW                                                               -1                1.0
                                          |--Hash Match(Inner Join, HASH:([TPCH].[dbo].[nation].[N_NationKey])=([TPCH].[dbo].[customer].[C_NationKey]), RESIDUAL:([TPCH].[dbo].[customer].[C_NationKey]=[TPCH].[dbo].[nation].[N_NationKey])DEFINE:([Opt_Bitmap1177]))                                                                                                                                                                                                                                                                         1          13          12 Hash Match                     Inner Join                     HASH:([TPCH].[dbo].[nation].[N_NationKey])=([TPCH].[dbo].[customer].[C_NationKey]), RESIDUAL:([TPCH].[dbo].[customer].[C_NationKey]=[TPCH].[dbo].[nation].[N_NationKey])                                                                                                                                                        [Opt_Bitmap1177]                                                                                                           900534.19            0.0     0.17375618          43        871.58521 [TPCH].[dbo].[lineitem].[L_SuppKey], [TPCH].[dbo].[nation].[N_NationKey], [TPCH].[dbo].[nation].[N_Name], [TPCH].[dbo].[nation].[N_RegionKey], [Expr1013]  NULL     PLAN_ROW                                                               -1                1.0
                                               |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[nation].[PK__nation__BD3779521509254A]),  WHERE:(PROBE([Opt_Bitmap1173],[TPCH].[dbo].[nation].[N_RegionKey])))                                                                                                                                                                                                                                                                                                                                    1          15          13 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[nation].[PK__nation__BD3779521509254A]),  WHERE:(PROBE([Opt_Bitmap1173],[TPCH].[dbo].[nation].[N_RegionKey]))                                                                                                                                                                                             [TPCH].[dbo].[nation].[N_NationKey], [TPCH].[dbo].[nation].[N_Name], [TPCH].[dbo].[nation].[N_RegionKey]                         2.5       0.003125   4.6118748E-5          26     3.1711187E-3 [TPCH].[dbo].[nation].[N_NationKey], [TPCH].[dbo].[nation].[N_Name], [TPCH].[dbo].[nation].[N_RegionKey]                                                   NULL     PLAN_ROW                                                               -1                1.0
                                               |--Hash Match(Inner Join, HASH:([TPCH].[dbo].[customer].[C_CustKey])=([TPCH].[dbo].[orders].[O_CustKey]), RESIDUAL:([TPCH].[dbo].[customer].[C_CustKey]=[TPCH].[dbo].[orders].[O_CustKey])DEFINE:([Opt_Bitmap1178]))                                                                                                                                                                                                                                                                            1          16          13 Hash Match                     Inner Join                     HASH:([TPCH].[dbo].[customer].[C_CustKey])=([TPCH].[dbo].[orders].[O_CustKey]), RESIDUAL:([TPCH].[dbo].[customer].[C_CustKey]=[TPCH].[dbo].[orders].[O_CustKey])                                                                                                                                                                [Opt_Bitmap1178]                                                                                                           900534.19            0.0     0.21736702          28        871.40833 [TPCH].[dbo].[customer].[C_NationKey], [TPCH].[dbo].[lineitem].[L_SuppKey], [Expr1013]                                                                     NULL     PLAN_ROW                                                               -1                1.0
                                                    |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[customer].[PK__customer__48695B71963F6D86]),  WHERE:(PROBE([Opt_Bitmap1177],[TPCH].[dbo].[customer].[C_NationKey])))                                                                                                                                                                                                                                                                                                                         1          18          16 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[customer].[PK__customer__48695B71963F6D86]),  WHERE:(PROBE([Opt_Bitmap1177],[TPCH].[dbo].[customer].[C_NationKey]))                                                                                                                                                                                       [TPCH].[dbo].[customer].[C_CustKey], [TPCH].[dbo].[customer].[C_NationKey]                                                  150000.0      24.779421     0.41216424          15        25.191586 [TPCH].[dbo].[customer].[C_CustKey], [TPCH].[dbo].[customer].[C_NationKey]                                                                                 NULL     PLAN_ROW                                                               -1                1.0
                                                    |--Compute Scalar(DEFINE:([Expr1013]=[TPCH].[dbo].[lineitem].[L_ExtendedPrice]*((1.)-[TPCH].[dbo].[lineitem].[L_Discount])))                                                                                                                                                                                                                                                                                                                                                               1          19          16 Compute Scalar                 Compute Scalar                 DEFINE:([Expr1013]=[TPCH].[dbo].[lineitem].[L_ExtendedPrice]*((1.)-[TPCH].[dbo].[lineitem].[L_Discount]))                                                                                                                                                                                                                       [Expr1013]=[TPCH].[dbo].[lineitem].[L_ExtendedPrice]*((1.)-[TPCH].[dbo].[lineitem].[L_Discount])                           900534.19            0.0   2.2513354E-2          28        845.86383 [TPCH].[dbo].[orders].[O_CustKey], [TPCH].[dbo].[lineitem].[L_SuppKey], [Expr1013]                                                                         NULL     PLAN_ROW                                                               -1                1.0
                                                         |--Nested Loops(Inner Join, OUTER REFERENCES:([TPCH].[dbo].[orders].[O_OrderKey], [Expr1222]) WITH UNORDERED PREFETCH)                                                                                                                                                                                                                                                                                                                                                                1          20          19 Nested Loops                   Inner Join                     OUTER REFERENCES:([TPCH].[dbo].[orders].[O_OrderKey], [Expr1222]) WITH UNORDERED PREFETCH                                                                                                                                                                                                                                       NULL                                                                                                                       900534.19            0.0     0.94105822          33        845.84131 [TPCH].[dbo].[orders].[O_CustKey], [TPCH].[dbo].[lineitem].[L_SuppKey], [TPCH].[dbo].[lineitem].[L_ExtendedPrice], [TPCH].[dbo].[lineitem].[L_Discount]    NULL     PLAN_ROW                                                               -1                1.0
                                                              |--Filter(WHERE:(PROBE([Opt_Bitmap1178],[TPCH].[dbo].[orders].[O_CustKey])))                                                                                                                                                                                                                                                                                                                                                                                                     1          22          20 Filter                         Filter                         WHERE:(PROBE([Opt_Bitmap1178],[TPCH].[dbo].[orders].[O_CustKey]))                                                                                                                                                                                                                                                               NULL                                                                                                                       225185.91            0.0            3.3          15         176.0011 [TPCH].[dbo].[orders].[O_OrderKey], [TPCH].[dbo].[orders].[O_CustKey]                                                                                      NULL     PLAN_ROW                                                               -1                1.0
                                                              |    |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[orders].[PK__orders__0F8A125214F3A7C2]),  WHERE:([TPCH].[dbo].[orders].[O_OrderDate]>='1997-01-01 00:00:00.000' AND [TPCH].[dbo].[orders].[O_OrderDate]<'1998-01-01 00:00:00.000') ORDERED FORWARD)                                                                                                                                                                                                                           1          24          22 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[orders].[PK__orders__0F8A125214F3A7C2]),  WHERE:([TPCH].[dbo].[orders].[O_OrderDate]>='1997-01-01 00:00:00.000' AND [TPCH].[dbo].[orders].[O_OrderDate]<'1998-01-01 00:00:00.000') ORDERED FORWARD                                                                                                        [TPCH].[dbo].[orders].[O_OrderKey], [TPCH].[dbo].[orders].[O_CustKey]                                                      225185.91      168.57867      4.1212893          23        172.69997 [TPCH].[dbo].[orders].[O_OrderKey], [TPCH].[dbo].[orders].[O_CustKey]                                                                                      NULL     PLAN_ROW                                                               -1                1.0
                                                              |--Clustered Index Seek(OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C]), SEEK:([TPCH].[dbo].[lineitem].[L_OrderKey]=[TPCH].[dbo].[orders].[O_OrderKey]) ORDERED FORWARD)                                                                                                                                                                                                                                                                                       1          25          20 Clustered Index Seek           Clustered Index Seek           OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C]), SEEK:([TPCH].[dbo].[lineitem].[L_OrderKey]=[TPCH].[dbo].[orders].[O_OrderKey]) ORDERED FORWARD                                                                                                                                                               [TPCH].[dbo].[lineitem].[L_SuppKey], [TPCH].[dbo].[lineitem].[L_ExtendedPrice], [TPCH].[dbo].[lineitem].[L_Discount]       3.9990699       0.003125   1.6139897E-4          29        668.89917 [TPCH].[dbo].[lineitem].[L_SuppKey], [TPCH].[dbo].[lineitem].[L_ExtendedPrice], [TPCH].[dbo].[lineitem].[L_Discount]                                       NULL     PLAN_ROW                                                               -1          225185.91

(20 rows affected)
