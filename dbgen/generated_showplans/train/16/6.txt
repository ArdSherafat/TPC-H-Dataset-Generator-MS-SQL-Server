StmtText                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 StmtId      NodeId      Parent      PhysicalOp                     LogicalOp                      Argument                                                                                                                                                                                                                                                                                                                                                                                                                                                                             DefinedValues                                                                                                               EstimateRows   EstimateIO     EstimateCPU    AvgRowSize  TotalSubtreeCost OutputList                                                                                                                       Warnings Type                                                             Parallel EstimateExecutions
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ----------- ----------- ----------- ------------------------------ ------------------------------ ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ --------------------------------------------------------------------------------------------------------------------------- -------------- -------------- -------------- ----------- ---------------- -------------------------------------------------------------------------------------------------------------------------------- -------- ---------------------------------------------------------------- -------- ------------------

select
	p_brand,
	p_type,
	p_size,
	count(distinct ps_suppkey) as supplier_cnt
from
	partsupp,
	part
where
	p_partkey = ps_partkey
	and p_brand <> 'Brand#21'
	and p_type not like 'STANDARD BRUSHED%'
	and p_size in (40, 33, 17, 9, 23, 28, 2, 3)
	and ps_suppkey not in (
		select
			s_suppkey
		from
			supplier
		where
			s_comment like '%Customer%Complaints%'
	)
group by
	p_brand,
	p_type,
	p_size
order by
	supplier_cnt desc,
	p_brand,
	p_type,
	p_size;                                             1           1           0 NULL                           NULL                           1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    NULL                                                                                                                             27839.812           NULL           NULL        NULL         149.2672 NULL                                                                                                                             NULL     SELECT                                                                  0               NULL
  |--Parallelism(Gather Streams, ORDER BY:([Expr1006] DESC, [TPCH].[dbo].[part].[P_Brand] ASC, [TPCH].[dbo].[part].[P_Type] ASC, [TPCH].[dbo].[part].[P_Size] ASC))                                                                                                                                                                                                                                                                                                                                                                                1           2           1 Parallelism                    Gather Streams                 ORDER BY:([Expr1006] DESC, [TPCH].[dbo].[part].[P_Brand] ASC, [TPCH].[dbo].[part].[P_Type] ASC, [TPCH].[dbo].[part].[P_Size] ASC)                                                                                                                                                                                                                                                                                                                                                    NULL                                                                                                                             27839.812            0.0      0.2090725          49         149.2672 [TPCH].[dbo].[part].[P_Brand], [TPCH].[dbo].[part].[P_Type], [TPCH].[dbo].[part].[P_Size], [Expr1006]                            NULL     PLAN_ROW                                                               -1                1.0
       |--Sort(ORDER BY:([Expr1006] DESC, [TPCH].[dbo].[part].[P_Brand] ASC, [TPCH].[dbo].[part].[P_Type] ASC, [TPCH].[dbo].[part].[P_Size] ASC))                                                                                                                                                                                                                                                                                                                                                                                                  1           3           2 Sort                           Sort                           ORDER BY:([Expr1006] DESC, [TPCH].[dbo].[part].[P_Brand] ASC, [TPCH].[dbo].[part].[P_Type] ASC, [TPCH].[dbo].[part].[P_Size] ASC)                                                                                                                                                                                                                                                                                                                                                    NULL                                                                                                                             27839.812   9.3843846E-4   4.7193114E-2          49        149.05809 [TPCH].[dbo].[part].[P_Brand], [TPCH].[dbo].[part].[P_Type], [TPCH].[dbo].[part].[P_Size], [Expr1006]                            NULL     PLAN_ROW                                                               -1                1.0
            |--Compute Scalar(DEFINE:([Expr1006]=CONVERT_IMPLICIT(int,[Expr1016],0)))                                                                                                                                                                                                                                                                                                                                                                                                                                                              1           4           3 Compute Scalar                 Compute Scalar                 DEFINE:([Expr1006]=CONVERT_IMPLICIT(int,[Expr1016],0))                                                                                                                                                                                                                                                                                                                                                                                                                               [Expr1006]=CONVERT_IMPLICIT(int,[Expr1016],0)                                                                                    27839.812            0.0            0.0          49        149.00996 [TPCH].[dbo].[part].[P_Brand], [TPCH].[dbo].[part].[P_Type], [TPCH].[dbo].[part].[P_Size], [Expr1006]                            NULL     PLAN_ROW                                                               -1                1.0
                 |--Hash Match(Aggregate, HASH:([TPCH].[dbo].[part].[P_Brand], [TPCH].[dbo].[part].[P_Type], [TPCH].[dbo].[part].[P_Size]), RESIDUAL:([TPCH].[dbo].[part].[P_Brand] = [TPCH].[dbo].[part].[P_Brand] AND [TPCH].[dbo].[part].[P_Type] = [TPCH].[dbo].[part].[P_Type] AND [TPCH].[dbo].[part].[P_Size] = [TPCH].[dbo].[part].[P_Size]) DEFINE:([Expr1016]=COUNT(DISTINCT [TPCH].[dbo].[partsupp].[PS_SuppKey])))                                                                                                                     1           5           4 Hash Match                     Aggregate                      HASH:([TPCH].[dbo].[part].[P_Brand], [TPCH].[dbo].[part].[P_Type], [TPCH].[dbo].[part].[P_Size]), RESIDUAL:([TPCH].[dbo].[part].[P_Brand] = [TPCH].[dbo].[part].[P_Brand] AND [TPCH].[dbo].[part].[P_Type] = [TPCH].[dbo].[part].[P_Type] AND [TPCH].[dbo].[part].[P_Size] = [TPCH].[dbo].[part].[P_Size])                                                                                                                                                                           [Expr1016]=COUNT(DISTINCT [TPCH].[dbo].[partsupp].[PS_SuppKey])                                                                  27839.812            0.0     0.27187303          49        149.00996 [TPCH].[dbo].[part].[P_Brand], [TPCH].[dbo].[part].[P_Type], [TPCH].[dbo].[part].[P_Size], [Expr1016]                            NULL     PLAN_ROW                                                               -1                1.0
                      |--Hash Match(Inner Join, HASH:([TPCH].[dbo].[part].[P_PartKey])=([TPCH].[dbo].[partsupp].[PS_PartKey])DEFINE:([Opt_Bitmap1015]))                                                                                                                                                                                                                                                                                                                                                                                            1           6           5 Hash Match                     Inner Join                     HASH:([TPCH].[dbo].[part].[P_PartKey])=([TPCH].[dbo].[partsupp].[PS_PartKey])                                                                                                                                                                                                                                                                                                                                                                                                        [Opt_Bitmap1015]                                                                                                                 1241057.6            0.0     0.52838838          49        148.73808 [TPCH].[dbo].[partsupp].[PS_SuppKey], [TPCH].[dbo].[part].[P_Brand], [TPCH].[dbo].[part].[P_Type], [TPCH].[dbo].[part].[P_Size]  NULL     PLAN_ROW                                                               -1                1.0
                           |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[part].[PK__part__418EE012D7A9C198]),  WHERE:([TPCH].[dbo].[part].[P_Brand]<>'Brand#21' AND NOT [TPCH].[dbo].[part].[P_Type] like 'STANDARD BRUSHED%' AND ([TPCH].[dbo].[part].[P_Size]=(2) OR [TPCH].[dbo].[part].[P_Size]=(3) OR [TPCH].[dbo].[part].[P_Size]=(9) OR [TPCH].[dbo].[part].[P_Size]=(17) OR [TPCH].[dbo].[part].[P_Size]=(23) OR [TPCH].[dbo].[part].[P_Size]=(28) OR [TPCH].[dbo].[part].[P_Size]=(33) OR [TPCH].[dbo].[part].[P_Size]=(40))))            1           7           6 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[part].[PK__part__418EE012D7A9C198]),  WHERE:([TPCH].[dbo].[part].[P_Brand]<>'Brand#21' AND NOT [TPCH].[dbo].[part].[P_Type] like 'STANDARD BRUSHED%' AND ([TPCH].[dbo].[part].[P_Size]=(2) OR [TPCH].[dbo].[part].[P_Size]=(3) OR [TPCH].[dbo].[part].[P_Size]=(9) OR [TPCH].[dbo].[part].[P_Size]=(17) OR [TPCH].[dbo].[part].[P_Size]=(23) OR [TPCH].[dbo].[part].[P_Size]=(28) OR [TPCH].[dbo].[part].[P_Size]=(33) OR [TPCH].[dbo].[part].[P_Size]=(40)))  [TPCH].[dbo].[part].[P_PartKey], [TPCH].[dbo].[part].[P_Brand], [TPCH].[dbo].[part].[P_Type], [TPCH].[dbo].[part].[P_Size]       310274.47      25.372755     0.55003923          49        25.922794 [TPCH].[dbo].[part].[P_PartKey], [TPCH].[dbo].[part].[P_Brand], [TPCH].[dbo].[part].[P_Type], [TPCH].[dbo].[part].[P_Size]       NULL     PLAN_ROW                                                               -1                1.0
                           |--Hash Match(Right Anti Semi Join, HASH:([TPCH].[dbo].[supplier].[S_SuppKey])=([TPCH].[dbo].[partsupp].[PS_SuppKey]))                                                                                                                                                                                                                                                                                                                                                                                                  1           8           6 Hash Match                     Right Anti Semi Join           HASH:([TPCH].[dbo].[supplier].[S_SuppKey])=([TPCH].[dbo].[partsupp].[PS_SuppKey])                                                                                                                                                                                                                                                                                                                                                                                                    NULL                                                                                                                             799974.06            0.0      0.1545538          15         120.3469 [TPCH].[dbo].[partsupp].[PS_PartKey], [TPCH].[dbo].[partsupp].[PS_SuppKey]                                                       NULL     PLAN_ROW                                                               -1                1.0
                                |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[supplier].[PK__supplier__C9D8C8B7D7E219CD]),  WHERE:([TPCH].[dbo].[supplier].[S_Comment] like '%Customer%Complaints%'))                                                                                                                                                                                                                                                                                                                                              1           9           8 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[supplier].[PK__supplier__C9D8C8B7D7E219CD]),  WHERE:([TPCH].[dbo].[supplier].[S_Comment] like '%Customer%Complaints%')                                                                                                                                                                                                                                                                                                                                         [TPCH].[dbo].[supplier].[S_SuppKey]                                                                                               3.238342      1.4505324     0.02753925          67        1.4780717 [TPCH].[dbo].[supplier].[S_SuppKey]                                                                                              NULL     PLAN_ROW                                                               -1                1.0
                                |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[partsupp].[PK__partsupp__087C85AD76D78946]),  WHERE:(PROBE([Opt_Bitmap1015],[TPCH].[dbo].[partsupp].[PS_PartKey])))                                                                                                                                                                                                                                                                                                                                                  1          11           8 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[partsupp].[PK__partsupp__087C85AD76D78946]),  WHERE:(PROBE([Opt_Bitmap1015],[TPCH].[dbo].[partsupp].[PS_PartKey]))                                                                                                                                                                                                                                                                                                                                             [TPCH].[dbo].[partsupp].[PS_PartKey], [TPCH].[dbo].[partsupp].[PS_SuppKey]                                                        800000.0      116.49424      2.1980393          15        118.69228 [TPCH].[dbo].[partsupp].[PS_PartKey], [TPCH].[dbo].[partsupp].[PS_SuppKey]                                                       NULL     PLAN_ROW                                                               -1                1.0

(10 rows affected)
