StmtText                                                                                                                                                                                                                                                                                                                                                                                                                                                                       StmtId      NodeId      Parent      PhysicalOp                     LogicalOp                      Argument                                                                                                                                                             DefinedValues                                                                                                                                     EstimateRows   EstimateIO     EstimateCPU    AvgRowSize  TotalSubtreeCost OutputList                                                                                                                                                                                        Warnings Type                                                             Parallel EstimateExecutions
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ ----------- ----------- ----------- ------------------------------ ------------------------------ -------------------------------------------------------------------------------------------------------------------------------------------------------------------- ------------------------------------------------------------------------------------------------------------------------------------------------- -------------- -------------- -------------- ----------- ---------------- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------- ---------------------------------------------------------------- -------- ------------------

select
top 100
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice,
	sum(l_quantity)
from
	customer,
	orders,
	lineitem
where
	o_orderkey in (
		select
			l_orderkey
		from
			lineitem
		group by
			l_orderkey having
				sum(l_quantity) > 314
	)
	and c_custkey = o_custkey
	and o_orderkey = l_orderkey
group by
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice
order by
	o_totalprice desc,
	o_orderdate;              1           1           0 NULL                           NULL                           1                                                                                                                                                                    NULL                                                                                                                                                       100.0           NULL           NULL        NULL         886.4826 NULL                                                                                                                                                                                              NULL     SELECT                                                                  0               NULL
  |--Top(TOP EXPRESSION:((100)))                                                                                                                                                                                                                                                                                                                                                                                                                                                         1           2           1 Top                            Top                            TOP EXPRESSION:((100))                                                                                                                                               NULL                                                                                                                                                       100.0            0.0   9.9999997E-6          72         886.4826 [TPCH].[dbo].[customer].[C_CustKey], [TPCH].[dbo].[customer].[C_Name], [TPCH].[dbo].[orders].[O_OrderKey], [TPCH].[dbo].[orders].[O_TotalPrice], [TPCH].[dbo].[orders].[O_OrderDate], [Expr1009]  NULL     PLAN_ROW                                                                0                1.0
       |--Nested Loops(Inner Join, OUTER REFERENCES:([TPCH].[dbo].[orders].[O_CustKey], [Expr1075]) WITH ORDERED PREFETCH)                                                                                                                                                                                                                                                                                                                                                               1           4           2 Nested Loops                   Inner Join                     OUTER REFERENCES:([TPCH].[dbo].[orders].[O_CustKey], [Expr1075]) WITH ORDERED PREFETCH                                                                               NULL                                                                                                                                                       100.0            0.0   1.1517175E-3          72         886.4826 [TPCH].[dbo].[customer].[C_CustKey], [TPCH].[dbo].[customer].[C_Name], [TPCH].[dbo].[orders].[O_OrderKey], [TPCH].[dbo].[orders].[O_TotalPrice], [TPCH].[dbo].[orders].[O_OrderDate], [Expr1009]  NULL     PLAN_ROW                                                                0                1.0
            |--Sort(ORDER BY:([TPCH].[dbo].[orders].[O_TotalPrice] DESC, [TPCH].[dbo].[orders].[O_OrderDate] ASC))                                                                                                                                                                                                                                                                                                                                                                       1           6           4 Sort                           Sort                           ORDER BY:([TPCH].[dbo].[orders].[O_TotalPrice] DESC, [TPCH].[dbo].[orders].[O_OrderDate] ASC)                                                                        NULL                                                                                                                                                       100.0   3.7537538E-3   1.8421418E-3          36        886.15533 [TPCH].[dbo].[orders].[O_OrderKey], [TPCH].[dbo].[orders].[O_CustKey], [TPCH].[dbo].[orders].[O_TotalPrice], [TPCH].[dbo].[orders].[O_OrderDate], [Expr1009]                                      NULL     PLAN_ROW                                                                0                1.0
            |    |--Nested Loops(Inner Join, OUTER REFERENCES:([TPCH].[dbo].[lineitem].[L_OrderKey], [Expr1074]) WITH UNORDERED PREFETCH)                                                                                                                                                                                                                                                                                                                                                1           8           6 Nested Loops                   Inner Join                     OUTER REFERENCES:([TPCH].[dbo].[lineitem].[L_OrderKey], [Expr1074]) WITH UNORDERED PREFETCH                                                                          NULL                                                                                                                                                   275.53049            0.0   1.1517175E-3          36        886.14948 [TPCH].[dbo].[orders].[O_OrderKey], [TPCH].[dbo].[orders].[O_CustKey], [TPCH].[dbo].[orders].[O_TotalPrice], [TPCH].[dbo].[orders].[O_OrderDate], [Expr1009]                                      NULL     PLAN_ROW                                                                0                1.0
            |         |--Compute Scalar(DEFINE:([Expr1009]=CASE WHEN [Expr1072]=(0) THEN NULL ELSE [Expr1073] END))                                                                                                                                                                                                                                                                                                                                                                      1          10           8 Compute Scalar                 Compute Scalar                 DEFINE:([Expr1009]=CASE WHEN [Expr1072]=(0) THEN NULL ELSE [Expr1073] END)                                                                                           [Expr1009]=CASE WHEN [Expr1072]=(0) THEN NULL ELSE [Expr1073] END                                                                                      275.53052            0.0            0.0          15        885.88727 [TPCH].[dbo].[lineitem].[L_OrderKey], [Expr1009]                                                                                                                                                  NULL     PLAN_ROW                                                                0                1.0
            |         |    |--Stream Aggregate(GROUP BY:([TPCH].[dbo].[lineitem].[L_OrderKey]) DEFINE:([Expr1072]=COUNT_BIG([TPCH].[dbo].[lineitem].[L_Quantity]), [Expr1073]=SUM([TPCH].[dbo].[lineitem].[L_Quantity])))                                                                                                                                                                                                                                                                1          11          10 Stream Aggregate               Aggregate                      GROUP BY:([TPCH].[dbo].[lineitem].[L_OrderKey])                                                                                                                      [Expr1072]=COUNT_BIG([TPCH].[dbo].[lineitem].[L_Quantity]), [Expr1073]=SUM([TPCH].[dbo].[lineitem].[L_Quantity])                                       275.53052            0.0   7.9888472E-4          15        885.88727 [TPCH].[dbo].[lineitem].[L_OrderKey], [Expr1072], [Expr1073]                                                                                                                                      NULL     PLAN_ROW                                                                0                1.0
            |         |         |--Nested Loops(Inner Join, OUTER REFERENCES:([TPCH].[dbo].[lineitem].[L_OrderKey], [Expr1071]) WITH ORDERED PREFETCH)                                                                                                                                                                                                                                                                                                                                   1          12          11 Nested Loops                   Inner Join                     OUTER REFERENCES:([TPCH].[dbo].[lineitem].[L_OrderKey], [Expr1071]) WITH ORDERED PREFETCH                                                                            NULL                                                                                                                                                   1101.8658            0.0    4.605799E-3          19        885.88641 [TPCH].[dbo].[lineitem].[L_OrderKey], [TPCH].[dbo].[lineitem].[L_Quantity], [TPCH].[dbo].[lineitem].[L_OrderKey]                                                                                  NULL     PLAN_ROW                                                                0                1.0
            |         |              |--Filter(WHERE:([Expr1008]>(314)))                                                                                                                                                                                                                                                                                                                                                                                                                 1          14          12 Filter                         Filter                         WHERE:([Expr1008]>(314))                                                                                                                                             NULL                                                                                                                                                   275.53052            0.0      7.2000003          11        884.97955 [TPCH].[dbo].[lineitem].[L_OrderKey]                                                                                                                                                              NULL     PLAN_ROW                                                                0                1.0
            |         |              |    |--Compute Scalar(DEFINE:([Expr1008]=CASE WHEN [Expr1069]=(0) THEN NULL ELSE [Expr1070] END))                                                                                                                                                                                                                                                                                                                                                  1          15          14 Compute Scalar                 Compute Scalar                 DEFINE:([Expr1008]=CASE WHEN [Expr1069]=(0) THEN NULL ELSE [Expr1070] END)                                                                                           [Expr1008]=CASE WHEN [Expr1069]=(0) THEN NULL ELSE [Expr1070] END                                                                                   1.5000001E+7            0.0            0.0          15        877.77954 [TPCH].[dbo].[lineitem].[L_OrderKey], [Expr1008]                                                                                                                                                  NULL     PLAN_ROW                                                                0                1.0
            |         |              |         |--Stream Aggregate(GROUP BY:([TPCH].[dbo].[lineitem].[L_OrderKey]) DEFINE:([Expr1069]=COUNT_BIG([TPCH].[dbo].[lineitem].[L_Quantity]), [Expr1070]=SUM([TPCH].[dbo].[lineitem].[L_Quantity])))                                                                                                                                                                                                                                            1          16          15 Stream Aggregate               Aggregate                      GROUP BY:([TPCH].[dbo].[lineitem].[L_OrderKey])                                                                                                                      [Expr1069]=COUNT_BIG([TPCH].[dbo].[lineitem].[L_Quantity]), [Expr1070]=SUM([TPCH].[dbo].[lineitem].[L_Quantity])                                    1.5000001E+7            0.0      43.491631          15        877.77954 [TPCH].[dbo].[lineitem].[L_OrderKey], [Expr1069], [Expr1070]                                                                                                                                      NULL     PLAN_ROW                                                                0                1.0
            |         |              |              |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C]), ORDERED FORWARD)                                                                                                                                                                                                                                                                                                                          1          17          16 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C]), ORDERED FORWARD                                                                                   [TPCH].[dbo].[lineitem].[L_OrderKey], [TPCH].[dbo].[lineitem].[L_Quantity]                                                                          5.9986052E+7       768.3031      65.984818          15        834.28796 [TPCH].[dbo].[lineitem].[L_OrderKey], [TPCH].[dbo].[lineitem].[L_Quantity]                                                                                                                        NULL     PLAN_ROW                                                                0                1.0
            |         |              |--Clustered Index Seek(OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C]), SEEK:([TPCH].[dbo].[lineitem].[L_OrderKey]=[TPCH].[dbo].[lineitem].[L_OrderKey]) ORDERED FORWARD)                                                                                                                                                                                                                                                        1          18          12 Clustered Index Seek           Clustered Index Seek           OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C]), SEEK:([TPCH].[dbo].[lineitem].[L_OrderKey]=[TPCH].[dbo].[lineitem].[L_OrderKey]) ORDERED FORWARD  [TPCH].[dbo].[lineitem].[L_OrderKey], [TPCH].[dbo].[lineitem].[L_Quantity]                                                                             3.9990699       0.003125   1.6139897E-4          15       0.90226507 [TPCH].[dbo].[lineitem].[L_OrderKey], [TPCH].[dbo].[lineitem].[L_Quantity]                                                                                                                        NULL     PLAN_ROW                                                                0          275.53052
            |         |--Clustered Index Seek(OBJECT:([TPCH].[dbo].[orders].[PK__orders__0F8A125214F3A7C2]), SEEK:([TPCH].[dbo].[orders].[O_OrderKey]=[TPCH].[dbo].[lineitem].[L_OrderKey]) ORDERED FORWARD)                                                                                                                                                                                                                                                                             1          19           8 Clustered Index Seek           Clustered Index Seek           OBJECT:([TPCH].[dbo].[orders].[PK__orders__0F8A125214F3A7C2]), SEEK:([TPCH].[dbo].[orders].[O_OrderKey]=[TPCH].[dbo].[lineitem].[L_OrderKey]) ORDERED FORWARD        [TPCH].[dbo].[orders].[O_OrderKey], [TPCH].[dbo].[orders].[O_CustKey], [TPCH].[dbo].[orders].[O_TotalPrice], [TPCH].[dbo].[orders].[O_OrderDate]             1.0       0.003125      0.0001581          32       0.26108339 [TPCH].[dbo].[orders].[O_OrderKey], [TPCH].[dbo].[orders].[O_CustKey], [TPCH].[dbo].[orders].[O_TotalPrice], [TPCH].[dbo].[orders].[O_OrderDate]                                                  NULL     PLAN_ROW                                                                0          275.53052
            |--Clustered Index Seek(OBJECT:([TPCH].[dbo].[customer].[PK__customer__48695B71963F6D86]), SEEK:([TPCH].[dbo].[customer].[C_CustKey]=[TPCH].[dbo].[orders].[O_CustKey]) ORDERED FORWARD)                                                                                                                                                                                                                                                                                     1          20           4 Clustered Index Seek           Clustered Index Seek           OBJECT:([TPCH].[dbo].[customer].[PK__customer__48695B71963F6D86]), SEEK:([TPCH].[dbo].[customer].[C_CustKey]=[TPCH].[dbo].[orders].[O_CustKey]) ORDERED FORWARD      [TPCH].[dbo].[customer].[C_CustKey], [TPCH].[dbo].[customer].[C_Name]                                                                                        1.0       0.003125      0.0001581          47        0.3273758 [TPCH].[dbo].[customer].[C_CustKey], [TPCH].[dbo].[customer].[C_Name]                                                                                                                             NULL     PLAN_ROW                                                                0           100.8077

(15 rows affected)
