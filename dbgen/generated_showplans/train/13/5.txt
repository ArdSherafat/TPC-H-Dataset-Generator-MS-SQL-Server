StmtText                                                                                                                                                                                                                                                                                                                                                        StmtId      NodeId      Parent      PhysicalOp                     LogicalOp                      Argument                                                                                                                                                          DefinedValues                                                         EstimateRows   EstimateIO     EstimateCPU    AvgRowSize  TotalSubtreeCost OutputList                                     Warnings Type                                                             Parallel EstimateExecutions
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ----------- ----------- ----------- ------------------------------ ------------------------------ ----------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------------------------------------------- -------------- -------------- -------------- ----------- ---------------- ---------------------------------------------- -------- ---------------------------------------------------------------- -------- ------------------

select
	c_count,
	count(*) as custdist
from
	(
		select
			c_custkey,
			count(o_orderkey)
		from
			customer left outer join orders on
				c_custkey = o_custkey
				and o_comment not like '%special%packages%'
		group by
			c_custkey
	) as c_orders (c_custkey, c_count)
group by
	c_count
order by
	custdist desc,
	c_count desc;              1           1           0 NULL                           NULL                           1                                                                                                                                                                 NULL                                                                            26.0           NULL           NULL        NULL        205.43452 NULL                                           NULL     SELECT                                                                  0               NULL
  |--Parallelism(Gather Streams, ORDER BY:([Expr1005] DESC, [Expr1004] DESC))                                                                                                                                                                                                                                                                                             1           2           1 Parallelism                    Gather Streams                 ORDER BY:([Expr1005] DESC, [Expr1004] DESC)                                                                                                                       NULL                                                                            26.0            0.0   2.8647112E-2          15        205.43452 [Expr1004], [Expr1005]                         NULL     PLAN_ROW                                                               -1                1.0
       |--Sort(ORDER BY:([Expr1005] DESC, [Expr1004] DESC))                                                                                                                                                                                                                                                                                                               1           3           2 Sort                           Sort                           ORDER BY:([Expr1005] DESC, [Expr1004] DESC)                                                                                                                       NULL                                                                            26.0   9.3843846E-4   2.9769995E-5          15        205.40587 [Expr1004], [Expr1005]                         NULL     PLAN_ROW                                                               -1                1.0
            |--Compute Scalar(DEFINE:([Expr1005]=CONVERT_IMPLICIT(int,[Expr1013],0)))                                                                                                                                                                                                                                                                                     1           4           3 Compute Scalar                 Compute Scalar                 DEFINE:([Expr1005]=CONVERT_IMPLICIT(int,[Expr1013],0))                                                                                                            [Expr1005]=CONVERT_IMPLICIT(int,[Expr1013],0)                                   26.0            0.0            0.0          15        205.40491 [Expr1004], [Expr1005]                         NULL     PLAN_ROW                                                               -1                1.0
                 |--Hash Match(Aggregate, HASH:([Expr1004]), RESIDUAL:([Expr1004] = [Expr1004]) DEFINE:([Expr1013]=COUNT(*)))                                                                                                                                                                                                                                             1           5           4 Hash Match                     Aggregate                      HASH:([Expr1004]), RESIDUAL:([Expr1004] = [Expr1004])                                                                                                             [Expr1013]=COUNT(*)                                                             26.0            0.0     0.26830477          15        205.40491 [Expr1004], [Expr1013]                         NULL     PLAN_ROW                                                               -1                1.0
                      |--Compute Scalar(DEFINE:([Expr1004]=CASE WHEN [Expr1004] IS NULL THEN (0) ELSE [Expr1004] END))                                                                                                                                                                                                                                                    1           6           5 Compute Scalar                 Compute Scalar                 DEFINE:([Expr1004]=CASE WHEN [Expr1004] IS NULL THEN (0) ELSE [Expr1004] END)                                                                                     [Expr1004]=CASE WHEN [Expr1004] IS NULL THEN (0) ELSE [Expr1004] END       1500000.0            0.0   3.7499999E-3          11         205.1366 [Expr1004]                                     NULL     PLAN_ROW                                                               -1                1.0
                           |--Hash Match(Right Outer Join, HASH:([TPCH].[dbo].[orders].[O_CustKey])=([TPCH].[dbo].[customer].[C_CustKey]), RESIDUAL:([TPCH].[dbo].[customer].[C_CustKey]=[TPCH].[dbo].[orders].[O_CustKey]))                                                                                                                                              1           7           6 Hash Match                     Right Outer Join               HASH:([TPCH].[dbo].[orders].[O_CustKey])=([TPCH].[dbo].[customer].[C_CustKey]), RESIDUAL:([TPCH].[dbo].[customer].[C_CustKey]=[TPCH].[dbo].[orders].[O_CustKey])  NULL                                                                       1500000.0            0.0     0.53135395          11        205.13284 [Expr1004]                                     NULL     PLAN_ROW                                                               -1                1.0
                                |--Compute Scalar(DEFINE:([Expr1004]=CONVERT_IMPLICIT(int,[Expr1012],0)))                                                                                                                                                                                                                                                                 1           8           7 Compute Scalar                 Compute Scalar                 DEFINE:([Expr1004]=CONVERT_IMPLICIT(int,[Expr1012],0))                                                                                                            [Expr1004]=CONVERT_IMPLICIT(int,[Expr1012],0)                               836170.0            0.0            0.0          15        179.40953 [TPCH].[dbo].[orders].[O_CustKey], [Expr1004]  NULL     PLAN_ROW                                                               -1                1.0
                                |    |--Hash Match(Aggregate, HASH:([TPCH].[dbo].[orders].[O_CustKey]), RESIDUAL:([TPCH].[dbo].[orders].[O_CustKey] = [TPCH].[dbo].[orders].[O_CustKey]) DEFINE:([Expr1012]=COUNT(*)))                                                                                                                                                    1           9           8 Hash Match                     Aggregate                      HASH:([TPCH].[dbo].[orders].[O_CustKey]), RESIDUAL:([TPCH].[dbo].[orders].[O_CustKey] = [TPCH].[dbo].[orders].[O_CustKey])                                        [Expr1012]=COUNT(*)                                                         836170.0            0.0       3.030813          15        179.40953 [TPCH].[dbo].[orders].[O_CustKey], [Expr1012]  NULL     PLAN_ROW                                                               -1                1.0
                                |         |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[orders].[PK__orders__0F8A125214F3A7C2]),  WHERE:(NOT [TPCH].[dbo].[orders].[O_Comment] like '%special%packages%'))                                                                                                                                                                1          10           9 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[orders].[PK__orders__0F8A125214F3A7C2]),  WHERE:(NOT [TPCH].[dbo].[orders].[O_Comment] like '%special%packages%')                           [TPCH].[dbo].[orders].[O_CustKey]                                       1.4894147E+7      168.57867      4.1250391          59        172.70372 [TPCH].[dbo].[orders].[O_CustKey]              NULL     PLAN_ROW                                                               -1                1.0
                                |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[customer].[PK__customer__48695B71963F6D86]))                                                                                                                                                                                                                                                1          11           7 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[customer].[PK__customer__48695B71963F6D86])                                                                                                 [TPCH].[dbo].[customer].[C_CustKey]                                        1500000.0      24.779421     0.41253924          11        25.191961 [TPCH].[dbo].[customer].[C_CustKey]            NULL     PLAN_ROW                                                               -1                1.0

(11 rows affected)
