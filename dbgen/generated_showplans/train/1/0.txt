StmtText                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   StmtId      NodeId      Parent      PhysicalOp                     LogicalOp                      Argument                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  DefinedValues                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    EstimateRows   EstimateIO     EstimateCPU    AvgRowSize  TotalSubtreeCost OutputList                                                                                                                                                                                                                              Warnings Type                                                             Parallel EstimateExecutions
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ ----------- ----------- ----------- ------------------------------ ------------------------------ ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------- -------------- -------------- ----------- ---------------- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------- ---------------------------------------------------------------- -------- ------------------

select
	l_returnflag,
	l_linestatus,
	sum(l_quantity) as sum_qty,
	sum(l_extendedprice) as sum_base_price,
	sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
	sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
	avg(l_quantity) as avg_qty,
	avg(l_extendedprice) as avg_price,
	avg(l_discount) as avg_disc,
	count(*) as count_order
from
	lineitem
where
	l_shipdate <= dateadd(dd, 117, cast('1998-12-01' as date))
group by
	l_returnflag,
	l_linestatus
order by
	l_returnflag,
	l_linestatus;                                                                                                                                                                                                                                                                                             1           1           0 NULL                           NULL                           1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         NULL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        6.0           NULL           NULL        NULL        802.83716 NULL                                                                                                                                                                                                                                    NULL     SELECT                                                                  0               NULL
  |--Parallelism(Gather Streams, ORDER BY:([TPCH].[dbo].[lineitem].[L_ReturnFlag] ASC, [TPCH].[dbo].[lineitem].[L_LineStatus] ASC))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  1           2           1 Parallelism                    Gather Streams                 ORDER BY:([TPCH].[dbo].[lineitem].[L_ReturnFlag] ASC, [TPCH].[dbo].[lineitem].[L_LineStatus] ASC)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         NULL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        6.0            0.0   2.8549887E-2         113        802.83716 [TPCH].[dbo].[lineitem].[L_ReturnFlag], [TPCH].[dbo].[lineitem].[L_LineStatus], [Expr1002], [Expr1003], [Expr1004], [Expr1005], [Expr1006], [Expr1007], [Expr1008], [Expr1009]                                                          NULL     PLAN_ROW                                                               -1                1.0
       |--Sort(ORDER BY:([TPCH].[dbo].[lineitem].[L_ReturnFlag] ASC, [TPCH].[dbo].[lineitem].[L_LineStatus] ASC))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    1           3           2 Sort                           Sort                           ORDER BY:([TPCH].[dbo].[lineitem].[L_ReturnFlag] ASC, [TPCH].[dbo].[lineitem].[L_LineStatus] ASC)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         NULL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        6.0   9.3843846E-4   2.5633131E-5         113        802.80859 [TPCH].[dbo].[lineitem].[L_ReturnFlag], [TPCH].[dbo].[lineitem].[L_LineStatus], [Expr1002], [Expr1003], [Expr1004], [Expr1005], [Expr1006], [Expr1007], [Expr1008], [Expr1009]                                                          NULL     PLAN_ROW                                                               -1                1.0
            |--Compute Scalar(DEFINE:([Expr1002]=CASE WHEN [Expr1042]=(0) THEN NULL ELSE [Expr1043] END, [Expr1003]=CASE WHEN [Expr1044]=(0) THEN NULL ELSE [Expr1045] END, [Expr1004]=CASE WHEN [Expr1046]=(0) THEN NULL ELSE [Expr1047] END, [Expr1005]=CASE WHEN [Expr1048]=(0) THEN NULL ELSE [Expr1049] END, [Expr1006]=CASE WHEN [Expr1042]=(0) THEN NULL ELSE [Expr1043]/CONVERT_IMPLICIT(int,[Expr1042],0) END, [Expr1007]=CASE WHEN [Expr1044]=(0) THEN NULL ELSE [Expr1045]/CONVERT_IMPLICIT(decimal(19,0),[Expr1044],0) END, [Expr1008]=CASE WHEN [Expr1050]=(0) THEN NULL ELSE [Expr1051]/CONVERT_IMPLICIT(decimal(19,0),[Expr1050],0) END, [Expr1009]=CONVERT_IMPLICIT(int,[Expr1052],0)))                                                                                                                                              1           4           3 Compute Scalar                 Compute Scalar                 DEFINE:([Expr1002]=CASE WHEN [Expr1042]=(0) THEN NULL ELSE [Expr1043] END, [Expr1003]=CASE WHEN [Expr1044]=(0) THEN NULL ELSE [Expr1045] END, [Expr1004]=CASE WHEN [Expr1046]=(0) THEN NULL ELSE [Expr1047] END, [Expr1005]=CASE WHEN [Expr1048]=(0) THEN NULL ELSE [Expr1049] END, [Expr1006]=CASE WHEN [Expr1042]=(0) THEN NULL ELSE [Expr1043]/CONVERT_IMPLICIT(int,[Expr1042],0) END, [Expr1007]=CASE WHEN [Expr1044]=(0) THEN NULL ELSE [Expr1045]/CONVERT_IMPLICIT(decimal(19,0),[Expr1044],0) END, [Expr1008]=CASE WHEN [Expr1050]=(0) THEN NULL ELSE [Expr1051]/CONVERT_IMPLICIT(decimal(19,0),[Expr1050],0) END, [Expr1009]=CONVERT_IMPLICIT(int,[Expr1052],0))  [Expr1002]=CASE WHEN [Expr1042]=(0) THEN NULL ELSE [Expr1043] END, [Expr1003]=CASE WHEN [Expr1044]=(0) THEN NULL ELSE [Expr1045] END, [Expr1004]=CASE WHEN [Expr1046]=(0) THEN NULL ELSE [Expr1047] END, [Expr1005]=CASE WHEN [Expr1048]=(0) THEN NULL ELSE [Expr1049] END, [Expr1006]=CASE WHEN [Expr1042]=(0) THEN NULL ELSE [Expr1043]/CONVERT_IMPLICIT(int,[Expr1042],0) END, [Expr1007]=CASE WHEN [Expr1044]=(0) THEN NULL ELSE [Expr1045]/CONVERT_IMPLICIT(decimal(19,0),[Expr1044],0) END, [Expr1008]=CASE WHEN [Expr1050]=(0) THEN NULL ELSE [Expr1051]/CONVERT_IMPLICIT(decimal(19,0),[Expr1050],0) END, [Expr1009]=CONVERT_IMPLICIT(int,[Expr1052],0)             6.0            0.0            0.0         113        802.80762 [TPCH].[dbo].[lineitem].[L_ReturnFlag], [TPCH].[dbo].[lineitem].[L_LineStatus], [Expr1002], [Expr1003], [Expr1004], [Expr1005], [Expr1006], [Expr1007], [Expr1008], [Expr1009]                                                          NULL     PLAN_ROW                                                               -1                1.0
                 |--Hash Match(Aggregate, HASH:([TPCH].[dbo].[lineitem].[L_ReturnFlag], [TPCH].[dbo].[lineitem].[L_LineStatus]), RESIDUAL:([TPCH].[dbo].[lineitem].[L_ReturnFlag] = [TPCH].[dbo].[lineitem].[L_ReturnFlag] AND [TPCH].[dbo].[lineitem].[L_LineStatus] = [TPCH].[dbo].[lineitem].[L_LineStatus]) DEFINE:([Expr1042]=COUNT_BIG([TPCH].[dbo].[lineitem].[L_Quantity]), [Expr1043]=SUM([TPCH].[dbo].[lineitem].[L_Quantity]), [Expr1044]=COUNT_BIG([TPCH].[dbo].[lineitem].[L_ExtendedPrice]), [Expr1045]=SUM([TPCH].[dbo].[lineitem].[L_ExtendedPrice]), [Expr1046]=COUNT_BIG([Expr1010]), [Expr1047]=SUM([Expr1010]), [Expr1048]=COUNT_BIG([Expr1011]), [Expr1049]=SUM([Expr1011]), [Expr1050]=COUNT_BIG([TPCH].[dbo].[lineitem].[L_Discount]), [Expr1051]=SUM([TPCH].[dbo].[lineitem].[L_Discount]), [Expr1052]=COUNT(*)))            1           5           4 Hash Match                     Aggregate                      HASH:([TPCH].[dbo].[lineitem].[L_ReturnFlag], [TPCH].[dbo].[lineitem].[L_LineStatus]), RESIDUAL:([TPCH].[dbo].[lineitem].[L_ReturnFlag] = [TPCH].[dbo].[lineitem].[L_ReturnFlag] AND [TPCH].[dbo].[lineitem].[L_LineStatus] = [TPCH].[dbo].[lineitem].[L_LineStatus])                                                                                                                                                                                                                                                                                                                                                                                                     [Expr1042]=COUNT_BIG([TPCH].[dbo].[lineitem].[L_Quantity]), [Expr1043]=SUM([TPCH].[dbo].[lineitem].[L_Quantity]), [Expr1044]=COUNT_BIG([TPCH].[dbo].[lineitem].[L_ExtendedPrice]), [Expr1045]=SUM([TPCH].[dbo].[lineitem].[L_ExtendedPrice]), [Expr1046]=COUNT_BIG([Expr1010]), [Expr1047]=SUM([Expr1010]), [Expr1048]=COUNT_BIG([Expr1011]), [Expr1049]=SUM([Expr1011]), [Expr1050]=COUNT_BIG([TPCH].[dbo].[lineitem].[L_Discount]), [Expr1051]=SUM([TPCH].[dbo].[lineitem].[L_Discount]), [Expr1052]=COUNT(*)                                                                                                                                                             6.0            0.0      10.660026         113        802.80762 [TPCH].[dbo].[lineitem].[L_ReturnFlag], [TPCH].[dbo].[lineitem].[L_LineStatus], [Expr1042], [Expr1043], [Expr1044], [Expr1045], [Expr1046], [Expr1047], [Expr1048], [Expr1049], [Expr1050], [Expr1051], [Expr1052]                      NULL     PLAN_ROW                                                               -1                1.0
                      |--Compute Scalar(DEFINE:([Expr1010]=[TPCH].[dbo].[lineitem].[L_ExtendedPrice]*((1.)-[TPCH].[dbo].[lineitem].[L_Discount]), [Expr1011]=[TPCH].[dbo].[lineitem].[L_ExtendedPrice]*((1.)-[TPCH].[dbo].[lineitem].[L_Discount])*((1.)+[TPCH].[dbo].[lineitem].[L_Tax])))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          1           6           5 Compute Scalar                 Compute Scalar                 DEFINE:([Expr1010]=[TPCH].[dbo].[lineitem].[L_ExtendedPrice]*((1.)-[TPCH].[dbo].[lineitem].[L_Discount]), [Expr1011]=[TPCH].[dbo].[lineitem].[L_ExtendedPrice]*((1.)-[TPCH].[dbo].[lineitem].[L_Discount])*((1.)+[TPCH].[dbo].[lineitem].[L_Tax]))                                                                                                                                                                                                                                                                                                                                                                                                                        [Expr1010]=[TPCH].[dbo].[lineitem].[L_ExtendedPrice]*((1.)-[TPCH].[dbo].[lineitem].[L_Discount]), [Expr1011]=[TPCH].[dbo].[lineitem].[L_ExtendedPrice]*((1.)-[TPCH].[dbo].[lineitem].[L_Discount])*((1.)+[TPCH].[dbo].[lineitem].[L_Tax])                                                                                                                                                                                                                                                                                                                                                                                                                          5.9986052E+7            0.0     0.14996514          75        784.94928 [TPCH].[dbo].[lineitem].[L_Quantity], [TPCH].[dbo].[lineitem].[L_ExtendedPrice], [TPCH].[dbo].[lineitem].[L_Discount], [TPCH].[dbo].[lineitem].[L_ReturnFlag], [TPCH].[dbo].[lineitem].[L_LineStatus], [Expr1010], [Expr1011]           NULL     PLAN_ROW                                                               -1                1.0
                           |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C]),  WHERE:([TPCH].[dbo].[lineitem].[L_ShipDate]<='1999-03-28'))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   1           7           6 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C]),  WHERE:([TPCH].[dbo].[lineitem].[L_ShipDate]<='1999-03-28')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            [TPCH].[dbo].[lineitem].[L_Quantity], [TPCH].[dbo].[lineitem].[L_ExtendedPrice], [TPCH].[dbo].[lineitem].[L_Discount], [TPCH].[dbo].[lineitem].[L_Tax], [TPCH].[dbo].[lineitem].[L_ReturnFlag], [TPCH].[dbo].[lineitem].[L_LineStatus]                                                                                                                                                                                                                                                                                                                                                                                                                             5.9986052E+7       768.3031      16.496204          54        784.79932 [TPCH].[dbo].[lineitem].[L_Quantity], [TPCH].[dbo].[lineitem].[L_ExtendedPrice], [TPCH].[dbo].[lineitem].[L_Discount], [TPCH].[dbo].[lineitem].[L_Tax], [TPCH].[dbo].[lineitem].[L_ReturnFlag], [TPCH].[dbo].[lineitem].[L_LineStatus]  NULL     PLAN_ROW                                                               -1                1.0

(7 rows affected)
