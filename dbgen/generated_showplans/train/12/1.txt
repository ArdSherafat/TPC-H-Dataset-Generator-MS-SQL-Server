StmtText                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       StmtId      NodeId      Parent      PhysicalOp                     LogicalOp                      Argument                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   DefinedValues                                                                                                                                                                                                                                                                                            EstimateRows   EstimateIO     EstimateCPU    AvgRowSize  TotalSubtreeCost OutputList                                                                   Warnings Type                                                             Parallel EstimateExecutions
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ----------- ----------- ----------- ------------------------------ ------------------------------ ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------- -------------- -------------- ----------- ---------------- ---------------------------------------------------------------------------- -------- ---------------------------------------------------------------- -------- ------------------

select
	l_shipmode,
	sum(case
		when o_orderpriority = '1-URGENT'
			or o_orderpriority = '2-HIGH'
			then 1
		else 0
	end) as high_line_count,
	sum(case
		when o_orderpriority <> '1-URGENT'
			and o_orderpriority <> '2-HIGH'
			then 1
		else 0
	end) as low_line_count
from
	orders,
	lineitem
where
	o_orderkey = l_orderkey
	and l_shipmode in ('AIR', 'REG AIR')
	and l_commitdate < l_receiptdate
	and l_shipdate < l_commitdate
	and l_receiptdate >= cast('1996-01-01' as datetime)
	and l_receiptdate < dateadd(yy, 1, cast('1996-01-01' as datetime))
group by
	l_shipmode
order by
	l_shipmode;              1           1           0 NULL                           NULL                           1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          NULL                                                                                                                                                                                                                                                                                                                2.0           NULL           NULL        NULL         1051.141 NULL                                                                         NULL     SELECT                                                                  0               NULL
  |--Stream Aggregate(GROUP BY:([TPCH].[dbo].[lineitem].[L_ShipMode]) DEFINE:([Expr1004]=SUM([partialagg1008]), [Expr1005]=SUM([partialagg1009])))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       1           2           1 Stream Aggregate               Aggregate                      GROUP BY:([TPCH].[dbo].[lineitem].[L_ShipMode])                                                                                                                                                                                                                                                                                                                                                                                                                                            [Expr1004]=SUM([partialagg1008]), [Expr1005]=SUM([partialagg1009])                                                                                                                                                                                                                                                  2.0            0.0   5.8000001E-6          23         1051.141 [TPCH].[dbo].[lineitem].[L_ShipMode], [Expr1004], [Expr1005]                 NULL     PLAN_ROW                                                                0                1.0
       |--Sort(ORDER BY:([TPCH].[dbo].[lineitem].[L_ShipMode] ASC))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      1           3           2 Sort                           Sort                           ORDER BY:([TPCH].[dbo].[lineitem].[L_ShipMode] ASC)                                                                                                                                                                                                                                                                                                                                                                                                                                        NULL                                                                                                                                                                                                                                                                                                                8.0   1.1261261E-2   1.3746299E-4          23         1051.141 [TPCH].[dbo].[lineitem].[L_ShipMode], [partialagg1008], [partialagg1009]     NULL     PLAN_ROW                                                                0                1.0
            |--Parallelism(Gather Streams)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               1           4           3 Parallelism                    Gather Streams                 NULL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       NULL                                                                                                                                                                                                                                                                                                                8.0            0.0   2.8507335E-2          23        1051.1295 [TPCH].[dbo].[lineitem].[L_ShipMode], [partialagg1008], [partialagg1009]     NULL     PLAN_ROW                                                               -1                1.0
                 |--Hash Match(Partial Aggregate, HASH:([TPCH].[dbo].[lineitem].[L_ShipMode]), RESIDUAL:([TPCH].[dbo].[lineitem].[L_ShipMode] = [TPCH].[dbo].[lineitem].[L_ShipMode]) DEFINE:([partialagg1008]=SUM([Expr1006]), [partialagg1009]=SUM([Expr1007])))                                                                                                                                                                                                                                                                                                                                                                                       1           5           4 Hash Match                     Partial Aggregate              HASH:([TPCH].[dbo].[lineitem].[L_ShipMode]), RESIDUAL:([TPCH].[dbo].[lineitem].[L_ShipMode] = [TPCH].[dbo].[lineitem].[L_ShipMode]), DEFINE:([partialagg1008]=SUM([Expr1006]), [partialagg1009]=SUM([Expr1007]))                                                                                                                                                                                                                                                                           [partialagg1008]=SUM([Expr1006]), [partialagg1009]=SUM([Expr1007])                                                                                                                                                                                                                                                  8.0            0.0      5.5044355          23        1051.1011 [TPCH].[dbo].[lineitem].[L_ShipMode], [partialagg1008], [partialagg1009]     NULL     PLAN_ROW                                                               -1                1.0
                      |--Hash Match(Inner Join, HASH:([TPCH].[dbo].[lineitem].[L_OrderKey])=([TPCH].[dbo].[orders].[O_OrderKey]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        1           6           5 Hash Match                     Inner Join                     HASH:([TPCH].[dbo].[lineitem].[L_OrderKey])=([TPCH].[dbo].[orders].[O_OrderKey])                                                                                                                                                                                                                                                                                                                                                                                                           NULL                                                                                                                                                                                                                                                                                                          3087936.0            0.0      38.676842          23        1045.5966 [TPCH].[dbo].[lineitem].[L_ShipMode], [Expr1006], [Expr1007]                 NULL     PLAN_ROW                                                               -1                1.0
                           |--Bitmap(HASH:([TPCH].[dbo].[lineitem].[L_OrderKey]), DEFINE:([Bitmap1011]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 1           7           6 Bitmap                         Bitmap Create                  HASH:([TPCH].[dbo].[lineitem].[L_OrderKey])                                                                                                                                                                                                                                                                                                                                                                                                                                                [Bitmap1011]                                                                                                                                                                                                                                                                                                  3087936.0            0.0      2.6773701          19        820.16907 [TPCH].[dbo].[lineitem].[L_OrderKey], [TPCH].[dbo].[lineitem].[L_ShipMode]   NULL     PLAN_ROW                                                               -1                1.0
                           |    |--Parallelism(Repartition Streams, Hash Partitioning, PARTITION COLUMNS:([TPCH].[dbo].[lineitem].[L_OrderKey]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         1           8           7 Parallelism                    Repartition Streams            PARTITION COLUMNS:([TPCH].[dbo].[lineitem].[L_OrderKey])                                                                                                                                                                                                                                                                                                                                                                                                                                   NULL                                                                                                                                                                                                                                                                                                          3087936.0            0.0      2.6773701          19        820.16907 [TPCH].[dbo].[lineitem].[L_OrderKey], [TPCH].[dbo].[lineitem].[L_ShipMode]   NULL     PLAN_ROW                                                               -1                1.0
                           |         |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C]), WHERE:([TPCH].[dbo].[lineitem].[L_ReceiptDate]>='1996-01-01 00:00:00.000' AND [TPCH].[dbo].[lineitem].[L_ReceiptDate]<'1997-01-01 00:00:00.000' AND [TPCH].[dbo].[lineitem].[L_CommitDate]<[TPCH].[dbo].[lineitem].[L_ReceiptDate] AND [TPCH].[dbo].[lineitem].[L_ShipDate]<[TPCH].[dbo].[lineitem].[L_CommitDate] AND ([TPCH].[dbo].[lineitem].[L_ShipMode]='AIR' OR [TPCH].[dbo].[lineitem].[L_ShipMode]='REG AIR')))                                                                                                  1           9           8 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C]), WHERE:([TPCH].[dbo].[lineitem].[L_ReceiptDate]>='1996-01-01 00:00:00.000' AND [TPCH].[dbo].[lineitem].[L_ReceiptDate]<'1997-01-01 00:00:00.000' AND [TPCH].[dbo].[lineitem].[L_CommitDate]<[TPCH].[dbo].[lineitem].[L_ReceiptDate] AND [TPCH].[dbo].[lineitem].[L_ShipDate]<[TPCH].[dbo].[lineitem].[L_CommitDate] AND ([TPCH].[dbo].[lineitem].[L_ShipMode]='AIR' OR [TPCH].[dbo].[lineitem].[L_ShipMode]='REG AIR'))  [TPCH].[dbo].[lineitem].[L_OrderKey], [TPCH].[dbo].[lineitem].[L_ShipMode]                                                                                                                                                                                                                                    3087936.0       768.3031      16.496204          43        784.79932 [TPCH].[dbo].[lineitem].[L_OrderKey], [TPCH].[dbo].[lineitem].[L_ShipMode]   NULL     PLAN_ROW                                                               -1                1.0
                           |--Compute Scalar(DEFINE:([Expr1006]=CASE WHEN [TPCH].[dbo].[orders].[O_OrderPriority]='1-URGENT' OR [TPCH].[dbo].[orders].[O_OrderPriority]='2-HIGH' THEN (1) ELSE (0) END, [Expr1007]=CASE WHEN [TPCH].[dbo].[orders].[O_OrderPriority]<>'1-URGENT' AND [TPCH].[dbo].[orders].[O_OrderPriority]<>'2-HIGH' THEN (1) ELSE (0) END))                                                                                                                                                                                                                                                                                           1          10           6 Compute Scalar                 Compute Scalar                 DEFINE:([Expr1006]=CASE WHEN [TPCH].[dbo].[orders].[O_OrderPriority]='1-URGENT' OR [TPCH].[dbo].[orders].[O_OrderPriority]='2-HIGH' THEN (1) ELSE (0) END, [Expr1007]=CASE WHEN [TPCH].[dbo].[orders].[O_OrderPriority]<>'1-URGENT' AND [TPCH].[dbo].[orders].[O_OrderPriority]<>'2-HIGH' THEN (1) ELSE (0) END)                                                                                                                                                                           [Expr1006]=CASE WHEN [TPCH].[dbo].[orders].[O_OrderPriority]='1-URGENT' OR [TPCH].[dbo].[orders].[O_OrderPriority]='2-HIGH' THEN (1) ELSE (0) END, [Expr1007]=CASE WHEN [TPCH].[dbo].[orders].[O_OrderPriority]<>'1-URGENT' AND [TPCH].[dbo].[orders].[O_OrderPriority]<>'2-HIGH' THEN (1) ELSE (0) END          1.5E+7            0.0          0.375          19        186.75066 [TPCH].[dbo].[orders].[O_OrderKey], [Expr1006], [Expr1007]                   NULL     PLAN_ROW                                                               -1                1.0
                                |--Parallelism(Repartition Streams, Hash Partitioning, PARTITION COLUMNS:([TPCH].[dbo].[orders].[O_OrderKey]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           1          11          10 Parallelism                    Repartition Streams            PARTITION COLUMNS:([TPCH].[dbo].[orders].[O_OrderKey])                                                                                                                                                                                                                                                                                                                                                                                                                                     NULL                                                                                                                                                                                                                                                                                                             1.5E+7            0.0      13.671938          22        186.37566 [TPCH].[dbo].[orders].[O_OrderKey], [TPCH].[dbo].[orders].[O_OrderPriority]  NULL     PLAN_ROW                                                               -1                1.0
                                     |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[orders].[PK__orders__0F8A125214F3A7C2]), WHERE:(PROBE([Bitmap1011],[TPCH].[dbo].[orders].[O_OrderKey],N'[IN ROW]')))                                                                                                                                                                                                                                                                                                                                                                                                                                                  1          12          11 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[orders].[PK__orders__0F8A125214F3A7C2]), WHERE:(PROBE([Bitmap1011],[TPCH].[dbo].[orders].[O_OrderKey],N'[IN ROW]'))                                                                                                                                                                                                                                                                                                                                                  [TPCH].[dbo].[orders].[O_OrderKey], [TPCH].[dbo].[orders].[O_OrderPriority]                                                                                                                                                                                                                                      1.5E+7      168.57867      4.1250391          22        172.70372 [TPCH].[dbo].[orders].[O_OrderKey], [TPCH].[dbo].[orders].[O_OrderPriority]  NULL     PLAN_ROW                                                               -1                1.0

(12 rows affected)
