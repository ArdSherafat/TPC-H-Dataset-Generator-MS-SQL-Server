StmtText                                                                                                                                                                                                                                                                                                                                                                                                                                                          StmtId      NodeId      Parent      PhysicalOp                     LogicalOp                      Argument                                                                                                                                                                                                     DefinedValues                                                                                                                                       EstimateRows   EstimateIO     EstimateCPU    AvgRowSize  TotalSubtreeCost OutputList                                                                                                                                          Warnings Type                                                             Parallel EstimateExecutions
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ----------- ----------- ----------- ------------------------------ ------------------------------ ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ --------------------------------------------------------------------------------------------------------------------------------------------------- -------------- -------------- -------------- ----------- ---------------- --------------------------------------------------------------------------------------------------------------------------------------------------- -------- ---------------------------------------------------------------- -------- ------------------

select
top 10
	l_orderkey,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	o_orderdate,
	o_shippriority
from
	customer,
	orders,
	lineitem
where
	c_mktsegment = 'BUILDING'
	and c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate < cast('1995-03-19' as datetime)
	and l_shipdate > cast('1995-03-19' as datetime)
group by
	l_orderkey,
	o_orderdate,
	o_shippriority
order by
	revenue desc,
	o_orderdate;              1           1           0 NULL                           NULL                           1                                                                                                                                                                                                            NULL                                                                                                                                                          10.0           NULL           NULL        NULL        1016.7205 NULL                                                                                                                                                NULL     SELECT                                                                  0               NULL
  |--Top(TOP EXPRESSION:((10)))                                                                                                                                                                                                                                                                                                                                                                                                                                             1           2           1 Top                            Top                            TOP EXPRESSION:((10))                                                                                                                                                                                        NULL                                                                                                                                                          10.0            0.0       0.000001          40        1016.7205 [TPCH].[dbo].[orders].[O_OrderDate], [TPCH].[dbo].[orders].[O_ShipPriority], [TPCH].[dbo].[lineitem].[L_OrderKey], [Expr1006]                       NULL     PLAN_ROW                                                                0                1.0
       |--Parallelism(Gather Streams, ORDER BY:([Expr1006] DESC, [TPCH].[dbo].[orders].[O_OrderDate] ASC))                                                                                                                                                                                                                                                                                                                                                                  1           4           2 Parallelism                    Gather Streams                 ORDER BY:([Expr1006] DESC, [TPCH].[dbo].[orders].[O_OrderDate] ASC)                                                                                                                                          NULL                                                                                                                                                          10.0            0.0   2.8582301E-2          40        1016.7205 [TPCH].[dbo].[orders].[O_OrderDate], [TPCH].[dbo].[orders].[O_ShipPriority], [TPCH].[dbo].[lineitem].[L_OrderKey], [Expr1006]                       NULL     PLAN_ROW                                                               -1                1.0
            |--Sort(ORDER BY:([Expr1006] DESC, [TPCH].[dbo].[orders].[O_OrderDate] ASC))                                                                                                                                                                                                                                                                                                                                                                                    1           5           4 Sort                           Sort                           ORDER BY:([Expr1006] DESC, [TPCH].[dbo].[orders].[O_OrderDate] ASC)                                                                                                                                          NULL                                                                                                                                                          10.0      19.033409      2.2623878          40        1016.6918 [TPCH].[dbo].[orders].[O_OrderDate], [TPCH].[dbo].[orders].[O_ShipPriority], [TPCH].[dbo].[lineitem].[L_OrderKey], [Expr1006]                       NULL     PLAN_ROW                                                               -1                1.0
                 |--Hash Match(Inner Join, HASH:([TPCH].[dbo].[orders].[O_OrderKey])=([TPCH].[dbo].[lineitem].[L_OrderKey])DEFINE:([Opt_Bitmap1031]))                                                                                                                                                                                                                                                                                                                       1           6           5 Hash Match                     Inner Join                     HASH:([TPCH].[dbo].[orders].[O_OrderKey])=([TPCH].[dbo].[lineitem].[L_OrderKey])                                                                                                                             [Opt_Bitmap1031]                                                                                                                                         2474322.2            0.0      1.3582587          40        995.39606 [TPCH].[dbo].[orders].[O_OrderDate], [TPCH].[dbo].[orders].[O_ShipPriority], [TPCH].[dbo].[lineitem].[L_OrderKey], [Expr1006]                       NULL     PLAN_ROW                                                               -1                1.0
                      |--Hash Match(Inner Join, HASH:([TPCH].[dbo].[customer].[C_CustKey])=([TPCH].[dbo].[orders].[O_CustKey]), RESIDUAL:([TPCH].[dbo].[customer].[C_CustKey]=[TPCH].[dbo].[orders].[O_CustKey])DEFINE:([Opt_Bitmap1029]))                                                                                                                                                                                                                                  1           7           6 Hash Match                     Inner Join                     HASH:([TPCH].[dbo].[customer].[C_CustKey])=([TPCH].[dbo].[orders].[O_CustKey]), RESIDUAL:([TPCH].[dbo].[customer].[C_CustKey]=[TPCH].[dbo].[orders].[O_CustKey])                                             [Opt_Bitmap1029]                                                                                                                                         2596149.0            0.0      1.1112219          23        200.98691 [TPCH].[dbo].[orders].[O_OrderKey], [TPCH].[dbo].[orders].[O_OrderDate], [TPCH].[dbo].[orders].[O_ShipPriority]                                     NULL     PLAN_ROW                                                               -1                1.0
                      |    |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[customer].[PK__customer__48695B71963F6D86]),  WHERE:([TPCH].[dbo].[customer].[C_MktSegment]='BUILDING'))                                                                                                                                                                                                                                                                                           1           8           7 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[customer].[PK__customer__48695B71963F6D86]),  WHERE:([TPCH].[dbo].[customer].[C_MktSegment]='BUILDING')                                                                                [TPCH].[dbo].[customer].[C_CustKey]                                                                                                                      296146.06      24.779421     0.41253924          24        25.191961 [TPCH].[dbo].[customer].[C_CustKey]                                                                                                                 NULL     PLAN_ROW                                                               -1                1.0
                      |    |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[orders].[PK__orders__0F8A125214F3A7C2]),  WHERE:([TPCH].[dbo].[orders].[O_OrderDate]<'1995-03-19 00:00:00.000' AND PROBE([Opt_Bitmap1029],[TPCH].[dbo].[orders].[O_CustKey])))                                                                                                                                                                                                                     1          10           7 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[orders].[PK__orders__0F8A125214F3A7C2]),  WHERE:([TPCH].[dbo].[orders].[O_OrderDate]<'1995-03-19 00:00:00.000' AND PROBE([Opt_Bitmap1029],[TPCH].[dbo].[orders].[O_CustKey]))          [TPCH].[dbo].[orders].[O_OrderKey], [TPCH].[dbo].[orders].[O_CustKey], [TPCH].[dbo].[orders].[O_OrderDate], [TPCH].[dbo].[orders].[O_ShipPriority]       7330240.5      168.57867      4.1250391          27        172.70372 [TPCH].[dbo].[orders].[O_OrderKey], [TPCH].[dbo].[orders].[O_CustKey], [TPCH].[dbo].[orders].[O_OrderDate], [TPCH].[dbo].[orders].[O_ShipPriority]  NULL     PLAN_ROW                                                               -1                1.0
                      |--Compute Scalar(DEFINE:([Expr1006]=CASE WHEN [Expr1044]=(0) THEN NULL ELSE [Expr1045] END))                                                                                                                                                                                                                                                                                                                                                         1          11           6 Compute Scalar                 Compute Scalar                 DEFINE:([Expr1006]=CASE WHEN [Expr1044]=(0) THEN NULL ELSE [Expr1045] END)                                                                                                                                   [Expr1006]=CASE WHEN [Expr1044]=(0) THEN NULL ELSE [Expr1045] END                                                                                        1429611.2            0.0            0.0          28         793.0509 [TPCH].[dbo].[lineitem].[L_OrderKey], [Expr1006]                                                                                                    NULL     PLAN_ROW                                                               -1                1.0
                           |--Hash Match(Aggregate, HASH:([TPCH].[dbo].[lineitem].[L_OrderKey]) DEFINE:([Expr1044]=COUNT_BIG([Expr1007]), [Expr1045]=SUM([Expr1007])))                                                                                                                                                                                                                                                                                                      1          12          11 Hash Match                     Aggregate                      HASH:([TPCH].[dbo].[lineitem].[L_OrderKey])                                                                                                                                                                  [Expr1044]=COUNT_BIG([Expr1007]), [Expr1045]=SUM([Expr1007])                                                                                             1429611.2            0.0      1.0602189          28         793.0509 [TPCH].[dbo].[lineitem].[L_OrderKey], [Expr1044], [Expr1045]                                                                                        NULL     PLAN_ROW                                                               -1                1.0
                                |--Compute Scalar(DEFINE:([Expr1007]=[TPCH].[dbo].[lineitem].[L_ExtendedPrice]*((1.)-[TPCH].[dbo].[lineitem].[L_Discount])))                                                                                                                                                                                                                                                                                                                1          13          12 Compute Scalar                 Compute Scalar                 DEFINE:([Expr1007]=[TPCH].[dbo].[lineitem].[L_ExtendedPrice]*((1.)-[TPCH].[dbo].[lineitem].[L_Discount]))                                                                                                    [Expr1007]=[TPCH].[dbo].[lineitem].[L_ExtendedPrice]*((1.)-[TPCH].[dbo].[lineitem].[L_Discount])                                                         3207178.8            0.0    8.017947E-3          24        791.99066 [TPCH].[dbo].[lineitem].[L_OrderKey], [Expr1007]                                                                                                    NULL     PLAN_ROW                                                               -1                1.0
                                     |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C]),  WHERE:([TPCH].[dbo].[lineitem].[L_ShipDate]>'1995-03-19 00:00:00.000' AND PROBE([Opt_Bitmap1031],[TPCH].[dbo].[lineitem].[L_OrderKey])))                                                                                                                                                                                                   1          15          13 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C]),  WHERE:([TPCH].[dbo].[lineitem].[L_ShipDate]>'1995-03-19 00:00:00.000' AND PROBE([Opt_Bitmap1031],[TPCH].[dbo].[lineitem].[L_OrderKey]))  [TPCH].[dbo].[lineitem].[L_OrderKey], [TPCH].[dbo].[lineitem].[L_ExtendedPrice], [TPCH].[dbo].[lineitem].[L_Discount]                                    3207178.8       768.3031      16.481207          37         784.7843 [TPCH].[dbo].[lineitem].[L_OrderKey], [TPCH].[dbo].[lineitem].[L_ExtendedPrice], [TPCH].[dbo].[lineitem].[L_Discount]                               NULL     PLAN_ROW                                                               -1                1.0

(12 rows affected)
