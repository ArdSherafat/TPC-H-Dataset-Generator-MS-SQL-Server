StmtText                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         StmtId      NodeId      Parent      PhysicalOp                     LogicalOp                      Argument                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    DefinedValues                                                                                                                                               EstimateRows   EstimateIO     EstimateCPU    AvgRowSize  TotalSubtreeCost OutputList                                                                                                                                                  Warnings Type                                                             Parallel EstimateExecutions
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ----------- ----------- ----------- ------------------------------ ------------------------------ ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------------------------------------------------------------------------------------------------------------------------- -------------- -------------- -------------- ----------- ---------------- ----------------------------------------------------------------------------------------------------------------------------------------------------------- -------- ---------------------------------------------------------------- -------- ------------------

select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#44'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 6 and l_quantity <= 6 + 10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#21'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 12 and l_quantity <= 12 + 10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#23'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 29 and l_quantity <= 29 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	);                                                                                                                                                                                                                                                                                                                                                                           1           1           0 NULL                           NULL                           1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           NULL                                                                                                                                                                   1.0           NULL           NULL        NULL        855.81549 NULL                                                                                                                                                        NULL     SELECT                                                                  0               NULL
  |--Parallelism(Gather Streams)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           1           2           1 Parallelism                    Gather Streams                 NULL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        NULL                                                                                                                                                                   1.0            0.0     0.02850277          24        855.81549 [Expr1004]                                                                                                                                                  NULL     PLAN_ROW                                                               -1                1.0
       |--Compute Scalar(DEFINE:([Expr1004]=CASE WHEN [Expr1012]=(0) THEN NULL ELSE [Expr1013] END))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       1           3           2 Compute Scalar                 Compute Scalar                 DEFINE:([Expr1004]=CASE WHEN [Expr1012]=(0) THEN NULL ELSE [Expr1013] END)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  [Expr1004]=CASE WHEN [Expr1012]=(0) THEN NULL ELSE [Expr1013] END                                                                                                      1.0            0.0            0.0          24        855.78699 [Expr1004]                                                                                                                                                  NULL     PLAN_ROW                                                               -1                1.0
            |--Hash Match(Aggregate, HASH:() DEFINE:([Expr1012]=COUNT_BIG([Expr1005]), [Expr1013]=SUM([Expr1005])))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        1           4           3 Hash Match                     Aggregate                      HASH:()                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     [Expr1012]=COUNT_BIG([Expr1005]), [Expr1013]=SUM([Expr1005])                                                                                                           1.0            0.0   2.3325018E-3          24        855.78699 [Expr1012], [Expr1013]                                                                                                                                      NULL     PLAN_ROW                                                               -1                1.0
                 |--Hash Match(Inner Join, HASH:([TPCH].[dbo].[part].[P_PartKey])=([TPCH].[dbo].[lineitem].[L_PartKey]), RESIDUAL:([TPCH].[dbo].[part].[P_PartKey]=[TPCH].[dbo].[lineitem].[L_PartKey] AND ([TPCH].[dbo].[part].[P_Brand]='Brand#44' AND ([TPCH].[dbo].[part].[P_Container]='SM BOX' OR [TPCH].[dbo].[part].[P_Container]='SM CASE' OR [TPCH].[dbo].[part].[P_Container]='SM PACK' OR [TPCH].[dbo].[part].[P_Container]='SM PKG') AND [TPCH].[dbo].[lineitem].[L_Quantity]>=(6) AND [TPCH].[dbo].[lineitem].[L_Quantity]<=(16) AND [TPCH].[dbo].[part].[P_Size]<=(5) OR [TPCH].[dbo].[part].[P_Brand]='Brand#21' AND ([TPCH].[dbo].[part].[P_Container]='MED BAG' OR [TPCH].[dbo].[part].[P_Container]='MED BOX' OR [TPCH].[dbo].[part].[P_Container]='MED PACK' OR [TPCH].[dbo].[part].[P_Container]='MED PKG') AND [TPCH].[dbo].[lineitem].[L_Quantity]>=(12) AND [TPCH].[dbo].[lineitem].[L_Quantity]<=(22) AND [TPCH].[dbo].[part].[P_Size]<=(10) OR [TPCH].[dbo].[part].[P_Brand]='Brand#23' AND ([TPCH].[dbo].[part].[P_Container]='LG BOX' OR [TPCH].[dbo].[part].[P_Container]='LG CASE' OR [TPCH].[dbo].[part].[P_Container]='LG PACK' OR [TPCH].[dbo].[part].[P_Container]='LG PKG') AND [TPCH].[dbo].[lineitem].[L_Quantity]>=(29) AND [TPCH].[dbo].[lineitem].[L_Quantity]<=(39) AND [TPCH].[dbo].[part].[P_Size]<=(15)))DEFINE:([Opt_Bitmap1011]))            1           5           4 Hash Match                     Inner Join                     HASH:([TPCH].[dbo].[part].[P_PartKey])=([TPCH].[dbo].[lineitem].[L_PartKey]), RESIDUAL:([TPCH].[dbo].[part].[P_PartKey]=[TPCH].[dbo].[lineitem].[L_PartKey] AND ([TPCH].[dbo].[part].[P_Brand]='Brand#44' AND ([TPCH].[dbo].[part].[P_Container]='SM BOX' OR [TPCH].[dbo].[part].[P_Container]='SM CASE' OR [TPCH].[dbo].[part].[P_Container]='SM PACK' OR [TPCH].[dbo].[part].[P_Container]='SM PKG') AND [TPCH].[dbo].[lineitem].[L_Quantity]>=(6) AND [TPCH].[dbo].[lineitem].[L_Quantity]<=(16) AND [TPCH].[dbo].[part].[P_Size]<=(5) OR [TPCH].[dbo].[part].[P_Brand]='Brand#21' AND ([TPCH].[dbo].[part].[P_Container]='MED BAG' OR [TPCH].[dbo].[part].[P_Container]='MED BOX' OR [TPCH].[dbo].[part].[P_Container]='MED PACK' OR [TPCH].[dbo].[part].[P_Container]='MED PKG') AND [TPCH].[dbo].[lineitem].[L_Quantity]>=(12) AND [TPCH].[dbo].[lineitem].[L_Quantity]<=(22) AND [TPCH].[dbo].[part].[P_Size]<=(10) OR [TPCH].[dbo].[part].[P_Brand]='Brand#23' AND ([TPCH].[dbo].[part].[P_Container]='LG BOX' OR [TPCH].[dbo].[part].[P_Container]='LG CASE' OR [TPCH].[dbo].[part].[P_Container]='LG PACK' OR [TPCH].[dbo].[part].[P_Container]='LG PKG') AND [TPCH].[dbo].[lineitem].[L_Quantity]>=(29) AND [TPCH].[dbo].[lineitem].[L_Quantity]<=(39) AND [TPCH].[dbo].[part].[P_Size]<=(15)))  [Opt_Bitmap1011]                                                                                                                                                 55742.516            0.0   4.5638017E-2          20        855.78467 [Expr1005]                                                                                                                                                  NULL     PLAN_ROW                                                               -1                1.0
                      |--Filter(WHERE:([TPCH].[dbo].[part].[P_Brand]='Brand#44' AND ([TPCH].[dbo].[part].[P_Container]='SM BOX' OR [TPCH].[dbo].[part].[P_Container]='SM CASE' OR [TPCH].[dbo].[part].[P_Container]='SM PACK' OR [TPCH].[dbo].[part].[P_Container]='SM PKG') AND [TPCH].[dbo].[part].[P_Size]<=(5) OR [TPCH].[dbo].[part].[P_Brand]='Brand#21' AND ([TPCH].[dbo].[part].[P_Container]='MED BAG' OR [TPCH].[dbo].[part].[P_Container]='MED BOX' OR [TPCH].[dbo].[part].[P_Container]='MED PACK' OR [TPCH].[dbo].[part].[P_Container]='MED PKG') AND [TPCH].[dbo].[part].[P_Size]<=(10) OR [TPCH].[dbo].[part].[P_Brand]='Brand#23' AND ([TPCH].[dbo].[part].[P_Container]='LG BOX' OR [TPCH].[dbo].[part].[P_Container]='LG CASE' OR [TPCH].[dbo].[part].[P_Container]='LG PACK' OR [TPCH].[dbo].[part].[P_Container]='LG PKG') AND [TPCH].[dbo].[part].[P_Size]<=(15)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    1           6           5 Filter                         Filter                         WHERE:([TPCH].[dbo].[part].[P_Brand]='Brand#44' AND ([TPCH].[dbo].[part].[P_Container]='SM BOX' OR [TPCH].[dbo].[part].[P_Container]='SM CASE' OR [TPCH].[dbo].[part].[P_Container]='SM PACK' OR [TPCH].[dbo].[part].[P_Container]='SM PKG') AND [TPCH].[dbo].[part].[P_Size]<=(5) OR [TPCH].[dbo].[part].[P_Brand]='Brand#21' AND ([TPCH].[dbo].[part].[P_Container]='MED BAG' OR [TPCH].[dbo].[part].[P_Container]='MED BOX' OR [TPCH].[dbo].[part].[P_Container]='MED PACK' OR [TPCH].[dbo].[part].[P_Container]='MED PKG') AND [TPCH].[dbo].[part].[P_Size]<=(10) OR [TPCH].[dbo].[part].[P_Brand]='Brand#23' AND ([TPCH].[dbo].[part].[P_Container]='LG BOX' OR [TPCH].[dbo].[part].[P_Container]='LG CASE' OR [TPCH].[dbo].[part].[P_Container]='LG PACK' OR [TPCH].[dbo].[part].[P_Container]='LG PKG') AND [TPCH].[dbo].[part].[P_Size]<=(15))                                                                                                                                                                                                                                                                                                                                                                                                                                                      NULL                                                                                                                                                             30079.439            0.0      3.3399999          36        29.262794 [TPCH].[dbo].[part].[P_PartKey], [TPCH].[dbo].[part].[P_Brand], [TPCH].[dbo].[part].[P_Size], [TPCH].[dbo].[part].[P_Container]                             NULL     PLAN_ROW                                                               -1                1.0
                      |    |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[part].[PK__part__418EE012D7A9C198]),  WHERE:([TPCH].[dbo].[part].[P_Size]>=(1)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  1           7           6 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[part].[PK__part__418EE012D7A9C198]),  WHERE:([TPCH].[dbo].[part].[P_Size]>=(1))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       [TPCH].[dbo].[part].[P_PartKey], [TPCH].[dbo].[part].[P_Brand], [TPCH].[dbo].[part].[P_Size], [TPCH].[dbo].[part].[P_Container]                                  30079.439      25.372755     0.55003923          36        25.922794 [TPCH].[dbo].[part].[P_PartKey], [TPCH].[dbo].[part].[P_Brand], [TPCH].[dbo].[part].[P_Size], [TPCH].[dbo].[part].[P_Container]                             NULL     PLAN_ROW                                                               -1                1.0
                      |--Compute Scalar(DEFINE:([Expr1005]=[TPCH].[dbo].[lineitem].[L_ExtendedPrice]*((1.)-[TPCH].[dbo].[lineitem].[L_Discount])))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         1           9           5 Compute Scalar                 Compute Scalar                 DEFINE:([Expr1005]=[TPCH].[dbo].[lineitem].[L_ExtendedPrice]*((1.)-[TPCH].[dbo].[lineitem].[L_Discount]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   [Expr1005]=[TPCH].[dbo].[lineitem].[L_ExtendedPrice]*((1.)-[TPCH].[dbo].[lineitem].[L_Discount])                                                                 37063.535            0.0   1.4996513E-3          50        784.78583 [TPCH].[dbo].[lineitem].[L_PartKey], [TPCH].[dbo].[lineitem].[L_Quantity], [Expr1005]                                                                       NULL     PLAN_ROW                                                               -1                1.0
                           |--Clustered Index Scan(OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C]),  WHERE:([TPCH].[dbo].[lineitem].[L_ShipInstruct]='DELIVER IN PERSON' AND ([TPCH].[dbo].[lineitem].[L_ShipMode]='AIR' OR [TPCH].[dbo].[lineitem].[L_ShipMode]='AIR REG') AND ([TPCH].[dbo].[lineitem].[L_Quantity]>=(6) AND [TPCH].[dbo].[lineitem].[L_Quantity]<=(22) OR [TPCH].[dbo].[lineitem].[L_Quantity]>=(29) AND [TPCH].[dbo].[lineitem].[L_Quantity]<=(39)) AND PROBE([Opt_Bitmap1011],[TPCH].[dbo].[lineitem].[L_PartKey])))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                1          10           9 Clustered Index Scan           Clustered Index Scan           OBJECT:([TPCH].[dbo].[lineitem].[PK__lineitem__2B16504E85092D9C]),  WHERE:([TPCH].[dbo].[lineitem].[L_ShipInstruct]='DELIVER IN PERSON' AND ([TPCH].[dbo].[lineitem].[L_ShipMode]='AIR' OR [TPCH].[dbo].[lineitem].[L_ShipMode]='AIR REG') AND ([TPCH].[dbo].[lineitem].[L_Quantity]>=(6) AND [TPCH].[dbo].[lineitem].[L_Quantity]<=(22) OR [TPCH].[dbo].[lineitem].[L_Quantity]>=(29) AND [TPCH].[dbo].[lineitem].[L_Quantity]<=(39)) AND PROBE([Opt_Bitmap1011],[TPCH].[dbo].[lineitem].[L_PartKey]))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     [TPCH].[dbo].[lineitem].[L_PartKey], [TPCH].[dbo].[lineitem].[L_Quantity], [TPCH].[dbo].[lineitem].[L_ExtendedPrice], [TPCH].[dbo].[lineitem].[L_Discount]       37063.535       768.3031      16.481207          55         784.7843 [TPCH].[dbo].[lineitem].[L_PartKey], [TPCH].[dbo].[lineitem].[L_Quantity], [TPCH].[dbo].[lineitem].[L_ExtendedPrice], [TPCH].[dbo].[lineitem].[L_Discount]  NULL     PLAN_ROW                                                               -1                1.0

(9 rows affected)
